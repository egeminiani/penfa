<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Penalized Factor Analysis • penfa</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/readable/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Penalized Factor Analysis">
<meta property="og:description" content="penfa">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-PQWMEC6S1Z"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PQWMEC6S1Z');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">penfa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/automatic-tuning-selection.html">Penalized Factor Analysis</a>
    </li>
    <li>
      <a href="../articles/grid-search-tuning-selection.html">Penalized Factor Analysis: grid search</a>
    </li>
    <li>
      <a href="../articles/articles/multiple-group-analysis.html">Penalized Multiple-Group Factor Analysis</a>
    </li>
    <li>
      <a href="../articles/articles/plotting-penalty-matrix.html">Plotting Penalty Matrices</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/egeminiani/penfa/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="automatic-tuning-selection_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Penalized Factor Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/egeminiani/penfa/blob/master/vignettes/automatic-tuning-selection.Rmd"><code>vignettes/automatic-tuning-selection.Rmd</code></a></small>
      <div class="hidden name"><code>automatic-tuning-selection.Rmd</code></div>

    </div>

    
    
<style type="text/css">
pre {
  max-height: 600px;
  overflow-y: auto;
}

pre[class] {
  max-height: 600px;
}
</style>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p><strong>Aim</strong>. This vignette shows how to fit a penalized factor analysis model using the routines in the <code>penfa</code> package. The penalty will automatically introduce sparsity in the factor loading matrix.</p>
<p><strong>Data</strong>. For illustration purposes, we use the cross-cultural data set <code>ccdata</code> containing the standardized ratings to 12 items concerning organizational citizenship behavior. Employees from different countries were asked to rate their attitudes towards helping other employees and giving suggestions for improved work conditions. The items are thought to measure two latent factors: <strong>help</strong>, defined by the first seven items (<code>h1</code> to <code>h7</code>), and <strong>voice</strong>, represented by the last five items (<code>v1</code> to <code>v5</code>). See <code><a href="../reference/ccdata.html">?ccdata</a></code> for details.</p>
<p>This data set is a standardized version of the one in the <a href="https://github.com/Jo-Karl/ccpsyc/"><code>ccpsyc</code></a> package, and only considers employees from Lebanon and Taiwan (i.e., <code>"LEB"</code>, <code>"TAIW"</code>). This vignette is meant as a demo of the capabilities of <code>penfa</code>; please refer to Fischer et al. (2019) and Fischer and Karl (2019) for a description and analysis of these data.</p>
<p>Let us load and inspect <code>ccdata</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/egeminiani/penfa">penfa</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">ccdata</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ccdata</span><span class="op">)</span>
<span class="co">##    country                h1                 h2                h3                 h4         </span>
<span class="co">##  Length:767         Min.   :-2.62004   Min.   :-2.9034   Min.   :-2.63082   Min.   :-3.0441  </span>
<span class="co">##  Class :character   1st Qu.:-0.69516   1st Qu.:-0.2163   1st Qu.:-0.70356   1st Qu.:-0.2720  </span>
<span class="co">##  Mode  :character   Median :-0.05354   Median : 0.4554   Median :-0.06114   Median : 0.4211  </span>
<span class="co">##                     Mean   : 0.00000   Mean   : 0.0000   Mean   : 0.00000   Mean   : 0.0000  </span>
<span class="co">##                     3rd Qu.: 0.58809   3rd Qu.: 0.4554   3rd Qu.: 0.58128   3rd Qu.: 0.4211  </span>
<span class="co">##                     Max.   : 1.22971   Max.   : 1.1272   Max.   : 1.22370   Max.   : 1.1141  </span>
<span class="co">##        h5                h6                h7                v1                  v2           </span>
<span class="co">##  Min.   :-2.9105   Min.   :-2.9541   Min.   :-2.8364   Min.   :-2.627694   Min.   :-2.674430  </span>
<span class="co">##  1st Qu.:-0.8662   1st Qu.:-0.9092   1st Qu.:-0.7860   1st Qu.:-0.660770   1st Qu.:-0.671219  </span>
<span class="co">##  Median : 0.4966   Median : 0.4541   Median :-0.1025   Median :-0.005129   Median :-0.003482  </span>
<span class="co">##  Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.000000   Mean   : 0.000000  </span>
<span class="co">##  3rd Qu.: 0.4966   3rd Qu.: 0.4541   3rd Qu.: 0.5810   3rd Qu.: 0.650512   3rd Qu.: 0.664255  </span>
<span class="co">##  Max.   : 1.1781   Max.   : 1.1358   Max.   : 1.2645   Max.   : 1.306154   Max.   : 1.331992  </span>
<span class="co">##        v3                 v4                 v5          </span>
<span class="co">##  Min.   :-2.65214   Min.   :-2.65722   Min.   :-2.51971  </span>
<span class="co">##  1st Qu.:-0.68800   1st Qu.:-0.68041   1st Qu.:-0.61127  </span>
<span class="co">##  Median :-0.03329   Median :-0.02148   Median : 0.02488  </span>
<span class="co">##  Mean   : 0.00000   Mean   : 0.00000   Mean   : 0.00000  </span>
<span class="co">##  3rd Qu.: 0.62142   3rd Qu.: 0.63746   3rd Qu.: 0.66103  </span>
<span class="co">##  Max.   : 1.27613   Max.   : 1.29639   Max.   : 1.29718</span></code></pre></div>
</div>
<div id="model-specification" class="section level2">
<h2 class="hasAnchor">
<a href="#model-specification" class="anchor"></a>Model specification</h2>
<p>Before fitting the model, we need to write a model syntax describing the relationships between the items and the latent factors. To facilitate its formulation, the rules for the syntax specification broadly follow the ones required by <a href="https://CRAN.R-project.org/package=lavaan/">lavaan</a>. The syntax must be enclosed in single quotes <code>' '</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">syntax</span> <span class="op">=</span> <span class="st">'help  =~   h1 + h2 + h3 + h4 + h5 + h6 + h7 + 0*v1 + v2 + v3 + v4 + v5
          voice =~ 0*h1 + h2 + h3 + h4 + h5 + h6 + h7 +   v1 + v2 + v3 + v4 + v5'</span></code></pre></div>
<p>The factors <code>help</code> and <code>voice</code> appear on the left-hand side, whereas the observed variables on the left-hand side. Following the rationale in Geminiani et al. (2021), we only specify the minimum number of identification constraints. We are setting the scales of the factors by fixing their factor variances to 1. This can be done in one of two ways: 1) by adding <code>'help ~~ 1*help'</code> and <code>'voice ~~ 1*voice'</code> to the syntax above; or 2) by setting the argument <code>std.lv = TRUE</code> in the fitting function (see below). To avoid rotational freedom, we fix one loading per factor to zero. Parameters can be easily fixed to user-defined values through the pre-multiplication mechanism. By default, unique variances are automatically added to the model, and the factors are allowed to correlate. These specifications can be modified by altering the syntax (see <code><a href="../reference/penfa.html">?penfa</a></code> for details on how to write the model syntax).</p>
</div>
<div id="model-fitting" class="section level2">
<h2 class="hasAnchor">
<a href="#model-fitting" class="anchor"></a>Model fitting</h2>
<p>The core of the package is given by the <code>penfa</code> function, a short form for <em>PENalized Factor Analysis</em>, that implements the framework discussed in Geminiani et al. (2021). By default, it employs the automatic procedure for the optimal selection of the tuning parameter(s), and the default value of the influence factor is 4. If needed, these choices can be altered by changing the values of the corresponding arguments (<code>strategy</code> and <code>gamma</code>) in the function call (see <code><a href="../reference/penfa.html">?penfa</a></code> and <code><a href="../reference/penfaOptions.html">?penfaOptions</a></code> for details).</p>
<p>The <code>penfa</code> function allows users to choose among a variety of penalty functions, including <strong>lasso</strong>, adaptive lasso (<strong>alasso</strong>), smoothly clipped absolute deviation (<strong>scad</strong>), minimax concave penalty (<strong>mcp</strong>), and <strong>ridge</strong>. Except for the latter, these penalties can produce sparse estimates. For the sake of completeness, <code>penfa</code> can also estimate an unpenalized model. In this vignette, we show how users can estimate a single-group penalized factor model with the lasso and alasso penalty. Before jumping to the penalization though, the next section illustrates the estimation of an unpenalized model, which is a necessary step for obtaining the adaptive weights demanded by the alasso.</p>
<div id="unpenalized-mle-model" class="section level3">
<h3 class="hasAnchor">
<a href="#unpenalized-mle-model" class="anchor"></a>Unpenalized (MLE) model</h3>
<p>The <code>penfa</code> function can also be used to estimate a factor model by ordinary maximum likelihood. The first argument is the user-specified model <code>syntax</code>, followed by the data set <code>ccdata</code> with the observed variables. The scales of the latent factors are specified by setting <code>std.lv = TRUE</code>. Because no penalization is required, the shrinkage penalty <code>pen.shrink</code> is set to <code>"none"</code>. The <code>eta</code> argument relates to the tuning parameter, so in this case it is set to zero. The argument <code>strategy = "fixed"</code> prompts the estimation of the model with the value of the tuning parameter in <code>eta</code>. By default, the Fisher information is used in the trust-region algorithm. Some messages on convergence and admissibility are shown by default; setting <code>verbose = FALSE</code> prevents printed output.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mle.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/penfa.html">penfa</a></span><span class="op">(</span><span class="co">## factor model </span>
                 model <span class="op">=</span> <span class="va">syntax</span>, 
                 data  <span class="op">=</span> <span class="va">ccdata</span>,
                 std.lv <span class="op">=</span> <span class="cn">TRUE</span>,
                 <span class="co">## (no) penalization</span>
                 pen.shrink <span class="op">=</span> <span class="st">"none"</span>,
                 eta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shrink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"none"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"none"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
                 strategy <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Largest absolute gradient value: 0.00108660</span>
<span class="co">## Fisher information matrix is positive definite</span>
<span class="co">## Eigenvalue range: [23.07573, 11057.36]</span>
<span class="co">## Trust region iterations: 18 </span>
<span class="co">## Factor solution: admissible </span>
<span class="co">## Computing VCOV ... done.</span>
<span class="co">## Effective degrees of freedom: 35</span></code></pre></div>
<p>The trust-region algorithm required a small number of iterations to converge. Since no penalization is imposed, the effective degrees of freedom (<em>edf</em>) coincide with the number of parameters. The estimated parameters can be extracted via the <code>coef</code> method. We collect them in the <code>mle.weights</code> vector, which will be used when fitting the penalized model with the alasso penalty.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mle.weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mle.fit</span><span class="op">)</span></code></pre></div>
<p>The <code>penfaOut</code> function can be called to have a quick look at the estimated parameter matrices. We notice that there are a couple of cross-loadings. In this case, it is convenient to resort to <strong>penalized factor analysis</strong> to encourage <em>sparsity</em> in the factor loading matrix through a shrinkage penalty function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/penfaOut.html">penfaOut</a></span><span class="op">(</span><span class="va">mle.fit</span><span class="op">)</span>
<span class="co">## $lambda</span>
<span class="co">##      help  voice</span>
<span class="co">## h1  0.782  0.000</span>
<span class="co">## h2  0.905 -0.031</span>
<span class="co">## h3  0.779  0.014</span>
<span class="co">## h4  0.986 -0.093</span>
<span class="co">## h5  0.783  0.100</span>
<span class="co">## h6  0.770  0.136</span>
<span class="co">## h7  0.530  0.354</span>
<span class="co">## v1  0.000  0.870</span>
<span class="co">## v2  0.055  0.837</span>
<span class="co">## v3  0.053  0.810</span>
<span class="co">## v4  0.013  0.850</span>
<span class="co">## v5 -0.004  0.827</span>
<span class="co">## </span>
<span class="co">## $psi</span>
<span class="co">##       h1    h2    h3    h4    h5    h6    h7    v1    v2    v3    v4    v5</span>
<span class="co">## h1 0.387 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000</span>
<span class="co">## h2 0.000 0.229 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000</span>
<span class="co">## h3 0.000 0.000 0.373 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000</span>
<span class="co">## h4 0.000 0.000 0.000 0.177 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000</span>
<span class="co">## h5 0.000 0.000 0.000 0.000 0.238 0.000 0.000 0.000 0.000 0.000 0.000 0.000</span>
<span class="co">## h6 0.000 0.000 0.000 0.000 0.000 0.204 0.000 0.000 0.000 0.000 0.000 0.000</span>
<span class="co">## h7 0.000 0.000 0.000 0.000 0.000 0.000 0.265 0.000 0.000 0.000 0.000 0.000</span>
<span class="co">## v1 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.242 0.000 0.000 0.000 0.000</span>
<span class="co">## v2 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.213 0.000 0.000 0.000</span>
<span class="co">## v3 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.265 0.000 0.000</span>
<span class="co">## v4 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.256 0.000</span>
<span class="co">## v5 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.321</span>
<span class="co">## </span>
<span class="co">## $phi</span>
<span class="co">##        help voice</span>
<span class="co">## help  1.000 0.875</span>
<span class="co">## voice 0.875 1.000</span></code></pre></div>
</div>
<div id="lasso" class="section level3">
<h3 class="hasAnchor">
<a href="#lasso" class="anchor"></a>Lasso</h3>
<p>We start off with the lasso, one of the simplest and widely-known penalty functions. In the function call, we now specify <code>pen.shrink = "lasso"</code>, and we provide through the <code>eta</code> argument a starting value for the tuning parameter (here 0.01) required by the automatic procedure (<code>strategy = "auto"</code>). The name given to the starting value (here, the factor loading matrix <code>"lambda"</code>) reflects the parameter matrix to be penalized. All of its elements are penalized, which means here that the penalization is applied to all factor loadings (except the ones fixed for identification). See <code><a href="../reference/penfaOptions.html">?penfaOptions</a></code> for additional details on the available options.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lasso.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/penfa.html">penfa</a></span><span class="op">(</span><span class="co">## factor model</span>
                   model  <span class="op">=</span> <span class="va">syntax</span>,
                   data   <span class="op">=</span> <span class="va">ccdata</span>,
                   std.lv <span class="op">=</span> <span class="cn">TRUE</span>,
                   <span class="co">## penalization</span>
                   pen.shrink <span class="op">=</span> <span class="st">"lasso"</span>,
                   eta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shrink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lambda"</span> <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>, diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"none"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
                   <span class="co">## automatic procedure</span>
                   strategy <span class="op">=</span> <span class="st">"auto"</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Automatic procedure: </span>
<span class="co">## Iteration  1 : 0.01403787 </span>
<span class="co">## </span>
<span class="co">## Largest absolute gradient value: 3.10138821</span>
<span class="co">## Fisher information matrix is positive definite</span>
<span class="co">## Eigenvalue range: [152.9943, 90518.23]</span>
<span class="co">## Trust region iterations: 16 </span>
<span class="co">## Factor solution: admissible </span>
<span class="co">## Effective degrees of freedom: 29.93813</span></code></pre></div>
<p>The <code>summary</code> method details information on the model characteristics, the optimization and penalization procedures as well as the parameter estimates with associated standard errors and confidence intervals. The optimal value of the tuning parameter for this lasso-penalized factor model is 0.014. The <em>Type</em> column distinguishes between the <em>fixed</em> parameters set to specific values for identification, the <em>free</em> parameters that have been estimated through ordinary maximum likelihood, and the penalized (<em>pen</em>) parameters. The standard errors here have been computed as the square root of the inverse of the penalized Fisher information matrix (Geminiani et al., 2021). The last columns report 95% confidence intervals (CI) for the model parameters. Standard errors and CI of the penalized parameters shrunken to zero are not displayed. A different significance level can be specified through the <code>level</code> argument in the <code>summary</code> call.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lasso.fit</span><span class="op">)</span>
<span class="co">## penfa 0.1.0 reached convergence</span>
<span class="co">## </span>
<span class="co">##   Number of observations                                    767</span>
<span class="co">##   Number of groups                                            1</span>
<span class="co">##   Number of observed variables                               12</span>
<span class="co">##   Number of latent factors                                    2</span>
<span class="co">##                                                                </span>
<span class="co">##   Estimator                                                PMLE</span>
<span class="co">##   Optimization method                              trust-region</span>
<span class="co">##   Information                                            fisher</span>
<span class="co">##   Strategy                                                 auto</span>
<span class="co">##   Number of iterations (total)                               32</span>
<span class="co">##   Number of two-steps (automatic)                             1</span>
<span class="co">##   Influence factor                                            4</span>
<span class="co">##   Number of parameters:                                        </span>
<span class="co">##     Free                                                     13</span>
<span class="co">##     Penalized                                                22</span>
<span class="co">##   Effective degrees of freedom                           29.938</span>
<span class="co">##   GIC                                                 17227.673</span>
<span class="co">##   GBIC                                                17366.660</span>
<span class="co">##                                                                </span>
<span class="co">##   Penalty function:                                            </span>
<span class="co">##     Sparsity                                              lasso</span>
<span class="co">##                                                                </span>
<span class="co">##   Optimal tuning parameter:                                    </span>
<span class="co">##     Sparsity                                                   </span>
<span class="co">##      - Factor loadings                                    0.014</span>
<span class="co">##                                                                </span>
<span class="co">## </span>
<span class="co">## Parameter Estimates:</span>
<span class="co">## </span>
<span class="co">## Latent Variables:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##   help =~                                                      </span>
<span class="co">##     h1               pen       0.748    0.030    0.691    0.806</span>
<span class="co">##     h2               pen       0.835    0.033    0.770    0.900</span>
<span class="co">##     h3               pen       0.718    0.048    0.624    0.811</span>
<span class="co">##     h4               pen       0.884    0.041    0.805    0.964</span>
<span class="co">##     h5               pen       0.717    0.047    0.625    0.810</span>
<span class="co">##     h6               pen       0.706    0.045    0.617    0.795</span>
<span class="co">##     h7               pen       0.483    0.046    0.392    0.574</span>
<span class="co">##     v1             fixed       0.000             0.000    0.000</span>
<span class="co">##     v2               pen       0.042                           </span>
<span class="co">##     v3               pen       0.040                           </span>
<span class="co">##     v4               pen       0.009                           </span>
<span class="co">##     v5               pen       0.000                           </span>
<span class="co">##   voice =~                                                     </span>
<span class="co">##     h1             fixed       0.000             0.000    0.000</span>
<span class="co">##     h2               pen       0.006                           </span>
<span class="co">##     h3               pen       0.044                           </span>
<span class="co">##     h4               pen      -0.022                           </span>
<span class="co">##     h5               pen       0.132    0.045    0.044    0.219</span>
<span class="co">##     h6               pen       0.166    0.043    0.081    0.250</span>
<span class="co">##     h7               pen       0.365    0.046    0.274    0.456</span>
<span class="co">##     v1               pen       0.832    0.028    0.778    0.887</span>
<span class="co">##     v2               pen       0.812    0.044    0.726    0.898</span>
<span class="co">##     v3               pen       0.784    0.045    0.697    0.872</span>
<span class="co">##     v4               pen       0.816    0.036    0.745    0.887</span>
<span class="co">##     v5               pen       0.786    0.029    0.730    0.843</span>
<span class="co">## </span>
<span class="co">## Covariances:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##   help ~~                                                      </span>
<span class="co">##     voice           free       0.855    0.015    0.825    0.884</span>
<span class="co">## </span>
<span class="co">## Variances:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##    .h1              free       0.384    0.021    0.342    0.426</span>
<span class="co">##    .h2              free       0.228    0.014    0.200    0.256</span>
<span class="co">##    .h3              free       0.372    0.021    0.331    0.413</span>
<span class="co">##    .h4              free       0.181    0.013    0.156    0.206</span>
<span class="co">##    .h5              free       0.239    0.014    0.211    0.267</span>
<span class="co">##    .h6              free       0.204    0.012    0.180    0.228</span>
<span class="co">##    .h7              free       0.265    0.015    0.236    0.293</span>
<span class="co">##    .v1              free       0.243    0.015    0.213    0.273</span>
<span class="co">##    .v2              free       0.212    0.014    0.185    0.239</span>
<span class="co">##    .v3              free       0.265    0.016    0.233    0.297</span>
<span class="co">##    .v4              free       0.257    0.016    0.226    0.289</span>
<span class="co">##    .v5              free       0.322    0.019    0.285    0.359</span>
<span class="co">##     help           fixed       1.000             1.000    1.000</span>
<span class="co">##     voice          fixed       1.000             1.000    1.000</span></code></pre></div>
</div>
<div id="alasso" class="section level3">
<h3 class="hasAnchor">
<a href="#alasso" class="anchor"></a>Alasso</h3>
<p>The potential problem with the lasso is its bias issue. To solve the problem, researchers have formulated the so-called <em>oracle</em> penalties, which include the alasso, scad, and mcp.</p>
<p>Since the scad and mcp cannot be used with the automatic procedure (model fitting is only possible for a fixed tuning value), we illustrate here the estimation process with the alasso penalty. As previously mentioned, the alasso requires a vector of adaptive weights. Although the <code>penfa</code> function can internally compute an unpenalized model to get these values, users can easily pass their own vector of values through the <code>weights</code> argument. The alasso relies on an additional tuning parameter (the exponent value). By default its value is set to 1, but users can increase it to encourage more sparsity (e.g., set <code>a.alasso = 2</code> in the <code>penfa</code> call).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alasso.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/penfa.html">penfa</a></span><span class="op">(</span><span class="co">## factor model</span>
                    model  <span class="op">=</span> <span class="va">syntax</span>,
                    data   <span class="op">=</span> <span class="va">ccdata</span>,
                    std.lv <span class="op">=</span> <span class="cn">TRUE</span>,
                    <span class="co">## penalization</span>
                    pen.shrink <span class="op">=</span> <span class="st">"alasso"</span>,
                    eta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shrink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lambda"</span> <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>, diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"none"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
                    <span class="co">## automatic procedure</span>
                    strategy <span class="op">=</span> <span class="st">"auto"</span>,
                    gamma <span class="op">=</span> <span class="fl">4</span>,
                    <span class="co">## alasso</span>
                    weights <span class="op">=</span> <span class="va">mle.weights</span>,
                    verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">alasso.fit</span>
<span class="co">## penfa 0.1.0 reached convergence</span>
<span class="co">## </span>
<span class="co">##   Number of observations                                    767</span>
<span class="co">##                                                                </span>
<span class="co">##   Estimator                                                PMLE</span>
<span class="co">##   Optimization method                              trust-region</span>
<span class="co">##   Information                                            fisher</span>
<span class="co">##   Strategy                                                 auto</span>
<span class="co">##   Number of iterations (total)                               58</span>
<span class="co">##   Number of two-steps (automatic)                             2</span>
<span class="co">##   Effective degrees of freedom                           27.129</span>
<span class="co">##                                                                </span>
<span class="co">##   Penalty function:                                            </span>
<span class="co">##     Sparsity                                             alasso</span>
<span class="co">##                                                                </span>
<span class="co">## </span></code></pre></div>
<p>The printed output gives an overview of the data and the optimization process, including the employed optimizer and penalty function, the total number of iterations and the number of outer iterations of the automatic procedure. The automatic procedure is very fast, as it required a couple of iterations to reach convergence.</p>
<div id="effective-degrees-of-freedom" class="section level4">
<h4 class="hasAnchor">
<a href="#effective-degrees-of-freedom" class="anchor"></a>Effective degrees of freedom</h4>
<p>The number of <em>edf</em> of this penalized model is 27.129, which is a fractional number, and is the sum of the contributions from the <em>edf</em> of each parameter.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alasso.fit</span><span class="op">@</span><span class="va">Inference</span><span class="op">$</span><span class="va">edf.single</span>
<span class="co">##     help=~h1     help=~h2     help=~h3     help=~h4     help=~h5     help=~h6 </span>
<span class="co">## 0.9947715501 0.9964627359 0.9948763923 0.9945258788 0.9914179923 0.9889262380 </span>
<span class="co">##     help=~h7     help=~v2     help=~v3     help=~v4     help=~v5    voice=~h2 </span>
<span class="co">## 0.9692182373 0.0006292259 0.0005203556 0.0001223770 0.0000319953 0.0003120181 </span>
<span class="co">##    voice=~h3    voice=~h4    voice=~h5    voice=~h6    voice=~h7    voice=~v1 </span>
<span class="co">## 0.0001076611 0.2901653639 0.3585496918 0.6371332419 0.9316357847 0.9962322251 </span>
<span class="co">##    voice=~v2    voice=~v3    voice=~v4    voice=~v5       h1~~h1       h2~~h2 </span>
<span class="co">## 0.9963020143 0.9958467402 0.9960609299 0.9955077902 1.0000000000 1.0000000000 </span>
<span class="co">##       h3~~h3       h4~~h4       h5~~h5       h6~~h6       h7~~h7       v1~~v1 </span>
<span class="co">## 1.0000000000 1.0000000000 1.0000000000 1.0000000000 1.0000000000 1.0000000000 </span>
<span class="co">##       v2~~v2       v3~~v3       v4~~v4       v5~~v5  help~~voice </span>
<span class="co">## 1.0000000000 1.0000000000 1.0000000000 1.0000000000 1.0000000000</span></code></pre></div>
</div>
<div id="summary" class="section level4">
<h4 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">alasso.fit</span><span class="op">)</span>
<span class="co">## penfa 0.1.0 reached convergence</span>
<span class="co">## </span>
<span class="co">##   Number of observations                                    767</span>
<span class="co">##   Number of groups                                            1</span>
<span class="co">##   Number of observed variables                               12</span>
<span class="co">##   Number of latent factors                                    2</span>
<span class="co">##                                                                </span>
<span class="co">##   Estimator                                                PMLE</span>
<span class="co">##   Optimization method                              trust-region</span>
<span class="co">##   Information                                            fisher</span>
<span class="co">##   Strategy                                                 auto</span>
<span class="co">##   Number of iterations (total)                               58</span>
<span class="co">##   Number of two-steps (automatic)                             2</span>
<span class="co">##   Influence factor                                            4</span>
<span class="co">##   Number of parameters:                                        </span>
<span class="co">##     Free                                                     13</span>
<span class="co">##     Penalized                                                22</span>
<span class="co">##   Effective degrees of freedom                           27.129</span>
<span class="co">##   GIC                                                 17222.980</span>
<span class="co">##   GBIC                                                17348.928</span>
<span class="co">##                                                                </span>
<span class="co">##   Penalty function:                                            </span>
<span class="co">##     Sparsity                                             alasso</span>
<span class="co">##                                                                </span>
<span class="co">##   Additional tuning parameter                                  </span>
<span class="co">##     alasso                                                    1</span>
<span class="co">##                                                                </span>
<span class="co">##   Optimal tuning parameter:                                    </span>
<span class="co">##     Sparsity                                                   </span>
<span class="co">##      - Factor loadings                                    0.005</span>
<span class="co">##                                                                </span>
<span class="co">## </span>
<span class="co">## Parameter Estimates:</span>
<span class="co">## </span>
<span class="co">## Latent Variables:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##   help =~                                                      </span>
<span class="co">##     h1               pen       0.766    0.030    0.707    0.825</span>
<span class="co">##     h2               pen       0.858    0.028    0.803    0.913</span>
<span class="co">##     h3               pen       0.775    0.030    0.717    0.834</span>
<span class="co">##     h4               pen       0.921    0.038    0.847    0.995</span>
<span class="co">##     h5               pen       0.810    0.040    0.732    0.887</span>
<span class="co">##     h6               pen       0.782    0.044    0.696    0.868</span>
<span class="co">##     h7               pen       0.523    0.050    0.426    0.620</span>
<span class="co">##     v1             fixed       0.000             0.000    0.000</span>
<span class="co">##     v2               pen       0.000                           </span>
<span class="co">##     v3               pen       0.000                           </span>
<span class="co">##     v4               pen       0.000                           </span>
<span class="co">##     v5               pen      -0.000                           </span>
<span class="co">##   voice =~                                                     </span>
<span class="co">##     h1             fixed       0.000             0.000    0.000</span>
<span class="co">##     h2               pen      -0.000                           </span>
<span class="co">##     h3               pen       0.000                           </span>
<span class="co">##     h4               pen      -0.041                           </span>
<span class="co">##     h5               pen       0.053    0.031   -0.008    0.114</span>
<span class="co">##     h6               pen       0.104    0.038    0.029    0.180</span>
<span class="co">##     h7               pen       0.341    0.049    0.246    0.437</span>
<span class="co">##     v1               pen       0.851    0.028    0.795    0.906</span>
<span class="co">##     v2               pen       0.871    0.028    0.817    0.926</span>
<span class="co">##     v3               pen       0.842    0.029    0.786    0.898</span>
<span class="co">##     v4               pen       0.843    0.029    0.787    0.899</span>
<span class="co">##     v5               pen       0.805    0.029    0.747    0.862</span>
<span class="co">## </span>
<span class="co">## Covariances:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##   help ~~                                                      </span>
<span class="co">##     voice           free       0.877    0.011    0.855    0.900</span>
<span class="co">## </span>
<span class="co">## Variances:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##    .h1              free       0.388    0.021    0.346    0.429</span>
<span class="co">##    .h2              free       0.233    0.014    0.205    0.261</span>
<span class="co">##    .h3              free       0.372    0.021    0.332    0.413</span>
<span class="co">##    .h4              free       0.184    0.012    0.160    0.209</span>
<span class="co">##    .h5              free       0.235    0.014    0.207    0.263</span>
<span class="co">##    .h6              free       0.201    0.012    0.177    0.225</span>
<span class="co">##    .h7              free       0.264    0.015    0.235    0.293</span>
<span class="co">##    .v1              free       0.245    0.015    0.216    0.275</span>
<span class="co">##    .v2              free       0.208    0.014    0.182    0.235</span>
<span class="co">##    .v3              free       0.261    0.016    0.230    0.292</span>
<span class="co">##    .v4              free       0.259    0.016    0.228    0.290</span>
<span class="co">##    .v5              free       0.324    0.019    0.287    0.361</span>
<span class="co">##     help           fixed       1.000             1.000    1.000</span>
<span class="co">##     voice          fixed       1.000             1.000    1.000</span></code></pre></div>
<p>The model produced a clear simple structure with the exception of a cross-loading for <code>h7</code> on the <code>voice</code> factor. The alasso penalty managed to set non-relevant loadings to zero without affecting the relevant coefficients.</p>
<p>If users desire solutions sparser than the ones produced by default, they can increase the value of the influence factor (e.g., <code>gamma = 4.5</code>; by default <code>gamma = 4</code>) or the exponent of the alasso (e.g., <code>a.alasso = 2</code>; by default <code>a.alasso = 1</code>). Conversely, if the obtained solution is deemed too sparse, the value of the influence factor can possibly be decreased up to 1.</p>
<p>In order to evaluate and choose among different penalized factor solutions, users can inspect the values of the generalized information criteria. In sparse settings, the GBIC (Generalized Bayesian Information criterion) is recommended. The GBIC can be retrieved from <code>alasso.fit@Inference$IC$BIC</code> or through the <code>BIC</code> function:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">BIC</a></span><span class="op">(</span><span class="va">alasso.fit</span><span class="op">)</span>
<span class="co">## [1] 17348.93</span></code></pre></div>
<p>Similarly, <code><a href="https://rdrr.io/r/stats/AIC.html">AIC(alasso.fit)</a></code> gives the GIC (Generalized Information Criterion), and <code><a href="https://rdrr.io/r/stats/logLik.html">logLik(alasso.fit)</a></code> the model log-likelihood (without the penalty term).</p>
</div>
<div id="implied-moments" class="section level4">
<h4 class="hasAnchor">
<a href="#implied-moments" class="anchor"></a>Implied moments</h4>
<p>The implied moments (here, the covariance matrix) can be found via the <code>fitted</code> method.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">implied</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">alasso.fit</span><span class="op">)</span>
<span class="va">implied</span>
<span class="co">## $cov</span>
<span class="co">##    h1    h2    h3    h4    h5    h6    h7    v1    v2    v3    v4    v5   </span>
<span class="co">## h1 0.974                                                                  </span>
<span class="co">## h2 0.657 0.969                                                            </span>
<span class="co">## h3 0.594 0.665 0.973                                                      </span>
<span class="co">## h4 0.678 0.759 0.686 0.968                                                </span>
<span class="co">## h5 0.655 0.734 0.664 0.757 0.968                                          </span>
<span class="co">## h6 0.669 0.749 0.677 0.772 0.749 0.966                                    </span>
<span class="co">## h7 0.630 0.706 0.638 0.724 0.708 0.727 0.967                              </span>
<span class="co">## v1 0.571 0.640 0.579 0.652 0.649 0.672 0.681 0.969                        </span>
<span class="co">## v2 0.585 0.656 0.593 0.668 0.665 0.689 0.697 0.741 0.968                  </span>
<span class="co">## v3 0.566 0.634 0.573 0.645 0.642 0.665 0.674 0.716 0.734 0.970            </span>
<span class="co">## v4 0.566 0.634 0.573 0.646 0.643 0.666 0.674 0.717 0.735 0.710 0.970      </span>
<span class="co">## v5 0.541 0.606 0.547 0.617 0.614 0.636 0.644 0.685 0.701 0.678 0.678 0.972</span></code></pre></div>
</div>
<div id="penalty-matrix" class="section level4">
<h4 class="hasAnchor">
<a href="#penalty-matrix" class="anchor"></a>Penalty matrix</h4>
<p>The penalty matrix is stored in <code>alasso.fit@Penalize@Sh.info$S.h</code>. Alternatively, it can be extracted via the <code>penmat</code> function (see below).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alasso_penmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/penmat.html">penmat</a></span><span class="op">(</span><span class="va">alasso.fit</span><span class="op">)</span></code></pre></div>
<p>The penalty matrix is diagonal with elements quantifying the extent to which each model parameters has been penalized. The values corresponding to the factor loadings are different from zero, as these are the penalized parameters, whereas the values for the unique variances (<code>h1~~h1</code> to <code>v5~~v5</code>) and the factor covariance (<code>help~~voice</code>) are zero, as these elements were not affected by the penalization. The magnitude of the penalization varies depending on the size of the loading to be penalized: small loadings received a considerable penalty, whereas large loadings a little one.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">alasso_penmat</span><span class="op">)</span></code></pre></div>
<pre><code>##    help=~h1    help=~h2    help=~h3    help=~h4    help=~h5    help=~h6 
##        5.80        4.47        5.75        3.82        5.47        5.76 
##    help=~h7    help=~v2    help=~v3    help=~v4    help=~v5   voice=~h2 
##       12.52   581469.16   638625.57  2723361.23  9187629.45  1097206.61 
##   voice=~h3   voice=~h4   voice=~h5   voice=~h6   voice=~h7   voice=~v1 
##  2457115.80      908.38      662.82      245.05       28.77        4.69 
##   voice=~v2   voice=~v3   voice=~v4   voice=~v5      h1~~h1      h2~~h2 
##        4.76        5.09        4.84        5.22        0.00        0.00 
##      h3~~h3      h4~~h4      h5~~h5      h6~~h6      h7~~h7      v1~~v1 
##        0.00        0.00        0.00        0.00        0.00        0.00 
##      v2~~v2      v3~~v3      v4~~v4      v5~~v5 help~~voice 
##        0.00        0.00        0.00        0.00        0.00</code></pre>
<p>See <a href="https://egeminiani.github.io/penfa/articles/articles/plotting-penalty-matrix.html">“plotting-penalty-matrix”</a> for details on how to produce an interactive plot of the penalty matrix.</p>
</div>
<div id="factor-scores" class="section level4">
<h4 class="hasAnchor">
<a href="#factor-scores" class="anchor"></a>Factor scores</h4>
<p>Lastly, the factor scores can be calculated via the <code>penfaPredict</code> function.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fscores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/penfaPredict.html">penfaPredict</a></span><span class="op">(</span><span class="va">alasso.fit</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">fscores</span><span class="op">)</span>
<span class="co">##             help      voice</span>
<span class="co">## [1,] -0.44516742  0.1487113</span>
<span class="co">## [2,] -0.09050701 -0.3588310</span>
<span class="co">## [3,]  0.57579146  0.7056186</span>
<span class="co">## [4,]  0.11063667  0.6259668</span>
<span class="co">## [5,]  0.38037518  0.8808153</span>
<span class="co">## [6,] -0.64225773 -0.4877660</span></code></pre></div>
</div>
</div>
</div>
<div id="r-session" class="section level2">
<h2 class="hasAnchor">
<a href="#r-session" class="anchor"></a>R Session</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">## R version 4.1.0 (2021-05-18)</span>
<span class="co">## Platform: x86_64-apple-darwin17.0 (64-bit)</span>
<span class="co">## Running under: macOS Catalina 10.15.7</span>
<span class="co">## </span>
<span class="co">## Matrix products: default</span>
<span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.dylib</span>
<span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib</span>
<span class="co">## </span>
<span class="co">## locale:</span>
<span class="co">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span>
<span class="co">## </span>
<span class="co">## attached base packages:</span>
<span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">## </span>
<span class="co">## other attached packages:</span>
<span class="co">## [1] penfa_0.1.0</span>
<span class="co">## </span>
<span class="co">## loaded via a namespace (and not attached):</span>
<span class="co">##  [1] VineCopula_2.4.2    magic_1.5-9         sfsmisc_1.1-11     </span>
<span class="co">##  [4] VGAM_1.1-5          splines_4.1.0       tmvnsim_1.0-2      </span>
<span class="co">##  [7] distr_2.8.0         stats4_4.1.0        yaml_2.2.1         </span>
<span class="co">## [10] numDeriv_2016.8-1.1 pillar_1.6.1        lattice_0.20-44    </span>
<span class="co">## [13] startupmsg_0.9.6    glue_1.4.2          digest_0.6.27      </span>
<span class="co">## [16] colorspace_2.0-2    htmltools_0.5.1.1   Matrix_1.3-3       </span>
<span class="co">## [19] survey_4.0          psych_2.1.6         pcaPP_1.9-74       </span>
<span class="co">## [22] pkgconfig_2.0.3     ismev_1.42          purrr_0.3.4        </span>
<span class="co">## [25] GJRM_0.2-4          mvtnorm_1.1-2       scales_1.1.1       </span>
<span class="co">## [28] copula_1.0-1        tibble_3.1.2        ADGofTest_0.3      </span>
<span class="co">## [31] gmp_0.6-2           mgcv_1.8-35         generics_0.1.0     </span>
<span class="co">## [34] ggplot2_3.3.5       ellipsis_0.3.2      cachem_1.0.5       </span>
<span class="co">## [37] distrEx_2.8.0       Rmpfr_0.8-4         mnormt_2.0.2       </span>
<span class="co">## [40] survival_3.2-11     magrittr_2.0.1      crayon_1.4.1       </span>
<span class="co">## [43] memoise_2.0.0       evaluate_0.14       fs_1.5.0           </span>
<span class="co">## [46] fansi_0.5.0         nlme_3.1-152        MASS_7.3-54        </span>
<span class="co">## [49] gsl_2.1-6           textshaping_0.3.5   tools_4.1.0        </span>
<span class="co">## [52] mitools_2.4         lifecycle_1.0.0     pspline_1.0-18     </span>
<span class="co">## [55] matrixStats_0.59.0  stringr_1.4.0       trust_0.1-8        </span>
<span class="co">## [58] munsell_0.5.0       stabledist_0.7-1    scam_1.2-11        </span>
<span class="co">## [61] gamlss.dist_5.3-2   compiler_4.1.0      pkgdown_1.6.1      </span>
<span class="co">## [64] evd_2.3-3           systemfonts_1.0.2   rlang_0.4.11       </span>
<span class="co">## [67] grid_4.1.0          trustOptim_0.8.6.2  rmarkdown_2.9      </span>
<span class="co">## [70] gtable_0.3.0        abind_1.4-5         DBI_1.1.1          </span>
<span class="co">## [73] R6_2.5.0            knitr_1.33          dplyr_1.0.7        </span>
<span class="co">## [76] fastmap_1.1.0       utf8_1.2.1          rprojroot_2.0.2    </span>
<span class="co">## [79] ragg_1.1.3          desc_1.3.0          matrixcalc_1.0-4   </span>
<span class="co">## [82] stringi_1.6.2       parallel_4.1.0      Rcpp_1.0.7         </span>
<span class="co">## [85] vctrs_0.3.8         tidyselect_1.1.1    xfun_0.24</span></code></pre></div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<ul>
<li><p>Fischer, R., Ferreira, M. C., Van Meurs, N. et al. (2019). “Does Organizational Formalization Facilitate Voice and Helping Organizational Citizenship Behaviors? It Depends on (National) Uncertainty Norms.” Journal of International Business Studies, 50(1), 125-134. <a href="https://doi.org/10.1057/s41267-017-0132-6">https://doi.org/10.1057/s41267-017-0132-6</a></p></li>
<li><p>Fischer, R., &amp; Karl, J. A. (2019). “A Primer to (Cross-Cultural) Multi-Group Invariance Testing Possibilities in R.” Frontiers in psychology, 10, 1507. <a href="https://doi.org/10.3389/fpsyg.2019.01507">https://doi.org/10.3389/fpsyg.2019.01507</a></p></li>
<li><p>Geminiani, E. (2020). “A Penalized Likelihood-Based Framework for Single and Multiple-Group Factor Analysis Models.” PhD thesis, University of Bologna. <a href="http://amsdottorato.unibo.it/9355/">http://amsdottorato.unibo.it/9355/</a></p></li>
<li><p>Geminiani, E., Marra, G., &amp; Moustaki, I. (2021). “Single- and Multiple-Group Penalized Factor Analysis: A Trust-Region Algorithm Approach with Integrated Automatic Multiple Tuning Parameter Selection.” Psychometrika, 86(1), 65-95. <a href="https://doi.org/10.1007/s11336-021-09751-8">https://doi.org/10.1007/s11336-021-09751-8</a></p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Elena Geminiani, Giampiero Marra, Irini Moustaki.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
