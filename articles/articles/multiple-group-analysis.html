<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Penalized Multiple-Group Factor Analysis • penfa</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/readable/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<meta property="og:title" content="Penalized Multiple-Group Factor Analysis">
<meta property="og:description" content="penfa">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-PQWMEC6S1Z"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PQWMEC6S1Z');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">penfa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/automatic-tuning-selection.html">Penalized Factor Analysis</a>
    </li>
    <li>
      <a href="../../articles/grid-search-tuning-selection.html">Penalized Factor Analysis: grid search</a>
    </li>
    <li>
      <a href="../../articles/articles/multiple-group-analysis.html">Penalized Multiple-Group Factor Analysis</a>
    </li>
    <li>
      <a href="../../articles/articles/plotting-penalty-matrix.html">Plotting Penalty Matrices</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/egeminiani/penfa/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="multiple-group-analysis_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Penalized Multiple-Group Factor Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/egeminiani/penfa/blob/master/vignettes/articles/multiple-group-analysis.Rmd"><code>vignettes/articles/multiple-group-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>multiple-group-analysis.Rmd</code></div>

    </div>

    
    
<style type="text/css">
pre {
  max-height: 600px;
  overflow-y: auto;
}

pre[class] {
  max-height: 600px;
}
</style>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p><strong>Aim</strong>. This vignette shows how to fit a penalized multiple-group factor analysis model with the alasso penalty using the routines in the <code>penfa</code> package. The penalties will automatically encourage sparsity in the factor structures, and invariance in the loadings and intercepts.</p>
<p><strong>Data</strong>. For illustration purposes, we use the cross-cultural data set <code>ccdata</code> containing the standardized ratings to 12 items concerning organizational citizenship behavior. Employees from different countries were asked to rate their attitudes towards helping other employees and giving suggestions for improved work conditions. The items are thought to measure two latent factors: <strong>help</strong>, defined by the first seven items (<code>h1</code> to <code>h7</code>), and <strong>voice</strong>, represented by the last five items (<code>v1</code> to <code>v5</code>). See <code><a href="../../reference/ccdata.html">?ccdata</a></code> for details.</p>
<p>This data set is a standardized version of the one in the <a href="https://github.com/Jo-Karl/ccpsyc/"><code>ccpsyc</code></a> package, and only considers employees from Lebanon and Taiwan (i.e., <code>"LEB"</code>, <code>"TAIW"</code>). The country of origin is the group variable for the multiple-group analysis. This vignette is meant as a demo of the capabilities of <code>penfa</code>; please refer to Fischer et al. (2019) and Fischer and Karl (2019) for a description and analysis of these data.</p>
<p>Let us load and inspect <code>ccdata</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/egeminiani/penfa">penfa</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">ccdata</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ccdata</span><span class="op">)</span>
<span class="co">##    country                h1                 h2                h3                 h4         </span>
<span class="co">##  Length:767         Min.   :-2.62004   Min.   :-2.9034   Min.   :-2.63082   Min.   :-3.0441  </span>
<span class="co">##  Class :character   1st Qu.:-0.69516   1st Qu.:-0.2163   1st Qu.:-0.70356   1st Qu.:-0.2720  </span>
<span class="co">##  Mode  :character   Median :-0.05354   Median : 0.4554   Median :-0.06114   Median : 0.4211  </span>
<span class="co">##                     Mean   : 0.00000   Mean   : 0.0000   Mean   : 0.00000   Mean   : 0.0000  </span>
<span class="co">##                     3rd Qu.: 0.58809   3rd Qu.: 0.4554   3rd Qu.: 0.58128   3rd Qu.: 0.4211  </span>
<span class="co">##                     Max.   : 1.22971   Max.   : 1.1272   Max.   : 1.22370   Max.   : 1.1141  </span>
<span class="co">##        h5                h6                h7                v1                  v2           </span>
<span class="co">##  Min.   :-2.9105   Min.   :-2.9541   Min.   :-2.8364   Min.   :-2.627694   Min.   :-2.674430  </span>
<span class="co">##  1st Qu.:-0.8662   1st Qu.:-0.9092   1st Qu.:-0.7860   1st Qu.:-0.660770   1st Qu.:-0.671219  </span>
<span class="co">##  Median : 0.4966   Median : 0.4541   Median :-0.1025   Median :-0.005129   Median :-0.003482  </span>
<span class="co">##  Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.000000   Mean   : 0.000000  </span>
<span class="co">##  3rd Qu.: 0.4966   3rd Qu.: 0.4541   3rd Qu.: 0.5810   3rd Qu.: 0.650512   3rd Qu.: 0.664255  </span>
<span class="co">##  Max.   : 1.1781   Max.   : 1.1358   Max.   : 1.2645   Max.   : 1.306154   Max.   : 1.331992  </span>
<span class="co">##        v3                 v4                 v5          </span>
<span class="co">##  Min.   :-2.65214   Min.   :-2.65722   Min.   :-2.51971  </span>
<span class="co">##  1st Qu.:-0.68800   1st Qu.:-0.68041   1st Qu.:-0.61127  </span>
<span class="co">##  Median :-0.03329   Median :-0.02148   Median : 0.02488  </span>
<span class="co">##  Mean   : 0.00000   Mean   : 0.00000   Mean   : 0.00000  </span>
<span class="co">##  3rd Qu.: 0.62142   3rd Qu.: 0.63746   3rd Qu.: 0.66103  </span>
<span class="co">##  Max.   : 1.27613   Max.   : 1.29639   Max.   : 1.29718</span></code></pre></div>
</div>
<div id="model-specification" class="section level2">
<h2 class="hasAnchor">
<a href="#model-specification" class="anchor"></a>Model specification</h2>
<p>The syntax becomes more elaborate than the one in <code><a href="../../articles/automatic-tuning-selection.html">vignette("automatic-tuning-selection")</a></code> due to the additional specification of the mean structure. Following the rationale in Geminiani et al. (2021), we only specify the minimum number of identification constraints. The metric of the factors is accommodated through the ‘marker-variable’ approach, with the markers being <code>h1</code> for <code>help</code> and <code>v1</code> for <code>voice</code>: the primary loadings of the markers are set to 1, and their intercepts to 0. To avoid rotational freedom, the secondary loading of the markers are set to zero. Intercepts for multiple variables can be introduced by specifying the variables of interest on the left-hand side, followed ‘+’ signs, and on the right-hand side the tilde operator <code><a href="https://rdrr.io/r/base/tilde.html">~</a></code> and the number 1. By default, factor means are fixed to zero. Provided that identification restrictions are applied, users can force the estimation of any model parameter through a pre-multiplication by <code>NA</code> (i.e., <code>'help  ~ NA*1'</code> and <code>'voice ~ NA*1'</code>). Alternatively, factor means can be estimated by setting <code>int.lv.free = TRUE</code> in the model function call. If the variable appearing in the intercept formulas is observed, then the formula specifies the intercept term for that item; if the variable is latent (i.e., a factor), then the formula specifies a factor mean. By default, unique variances are automatically added to the model, and the factors are allowed to correlate.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">syntax.mg</span> <span class="op">=</span> <span class="st">'help  =~ 1*h1 +          h2 +          h3 + h4 + h5 + h6 + h7 + 0*v1 + v2 + v3 + v4 + v5
             voice =~ 0*h1 + start(0)*h2 + start(0)*h3 + h4 + h5 + h6 + h7 + 1*v1 + v2 + v3 + v4 + v5
             
             h2 + h3 + h4 + h5 + h6 + h7 + v2 + v3 + v4 + v5 ~ 1 
             help  ~ NA*1
             voice ~ NA*1 '</span></code></pre></div>
<p>Users can take advantage of the <code><a href="https://rdrr.io/r/stats/start.html">start()</a></code> function to provide informative starting values to some model parameters and hence facilitate the estimation process. In the syntax above, we specified the starting values for two secondary loadings to zero. These specifications can be modified by altering the syntax (see <code><a href="../../reference/penfa.html">?penfa</a></code> for details on how to write the model syntax).</p>
</div>
<div id="model-fitting" class="section level2">
<h2 class="hasAnchor">
<a href="#model-fitting" class="anchor"></a>Model fitting</h2>
<p>As discussed in <code><a href="../../articles/automatic-tuning-selection.html">vignette("automatic-tuning-selection")</a></code>, we first fit an unpenalized model to obtain the maximum likelihood estimates to be used as weights for the alasso. In the <code>group</code> argument, we indicate the name of the group variable in the data set, which is the <code>country</code> of origin of the employees. We also set <code>pen.shrink = "none"</code>, and <code>strategy = "fixed"</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mle.fitMG</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/penfa.html">penfa</a></span><span class="op">(</span><span class="co">## factor model</span>
                   model <span class="op">=</span> <span class="va">syntax.mg</span>,
                   data  <span class="op">=</span> <span class="va">ccdata</span>,
                   group <span class="op">=</span> <span class="st">"country"</span>,
                   <span class="co">## (no) penalization</span>
                   pen.shrink <span class="op">=</span> <span class="st">"none"</span>,
                   pen.diff <span class="op">=</span> <span class="st">"none"</span>,
                   eta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shrink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lambda"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"none"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
                   strategy <span class="op">=</span> <span class="st">"fixed"</span>,
                   verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </code></pre></div>
<p>The estimated parameters can be extracted via the <code>coef</code> method. We collect them in the <code>mle.weightsMG</code> vector, which will be used when fitting the penalized multiple-group model with the alasso penalty.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mle.weightsMG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mle.fitMG</span><span class="op">)</span></code></pre></div>
<p>We can now estimate a penalized multiple-group model with the alasso penalty. Following the rationale in Geminiani et al. (2021), we specify the following penalties:</p>
<ul>
<li>
<strong>Penalty 1</strong>: sparsity in the loading matrix of each group</li>
<li>
<strong>Penalty 2</strong>: cross-group invariance of loadings</li>
<li>
<strong>Penalty 3</strong>: cross-group invariance of intercepts</li>
</ul>
<p>This makes up for a total of three tuning parameters, whose optimal values can be fast and efficiently estimated through the automatic tuning procedure. The argument <code>pen.shrink</code> specifies the function for Penalty 1 (shrinkage), whereas <code>pen.diff</code> the penalty function for Penalties 2 and 3 (shrinkage of pairwise group differences). The names <code>"lambda"</code> and <code>"tau"</code> in the <code>eta</code> argument clarify that the shrinkage penalty has to be applied on the loadings, and the invariance penalty on both loadings and intercepts. The numeric values in <code>eta</code> constitute the starting values for each tuning value. By default the alasso penalty is computed with the exponent equal to 1, and the automatic procedure uses an influence factor of 4. Users desiring sparser solutions are encouraged to try higher values for these quantities through the corresponding arguments (<code>a.alasso</code>, <code>gamma</code>) in the <code>penfa</code> call.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alasso.fitMG</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/penfa.html">penfa</a></span><span class="op">(</span><span class="co">## factor model</span>
                      model <span class="op">=</span> <span class="va">syntax.mg</span>,
                      data <span class="op">=</span> <span class="va">ccdata</span>,
                      group <span class="op">=</span> <span class="st">"country"</span>,
                      int.lv.free <span class="op">=</span> <span class="cn">TRUE</span>,
                      <span class="co">## penalization</span>
                      pen.shrink <span class="op">=</span> <span class="st">"alasso"</span>,
                      pen.diff <span class="op">=</span> <span class="st">"alasso"</span>,
                      eta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shrink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lambda"</span> <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>,
                                 diff   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lambda"</span> <span class="op">=</span> <span class="fl">0.1</span>, <span class="st">"tau"</span> <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span>,
                      <span class="co">## automatic procedure</span>
                      strategy <span class="op">=</span> <span class="st">"auto"</span>,
                      gamma <span class="op">=</span> <span class="fl">4</span>,
                      <span class="co">## alasso</span>
                      weights <span class="op">=</span> <span class="va">mle.weightsMG</span>,
                      verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Automatic procedure: </span>
<span class="co">## Iteration  1 : 0.00215674 827.66749181 0.00300201 </span>
<span class="co">## Iteration  2 : 0.00196781 29643.22874071 0.00772724 </span>
<span class="co">## </span>
<span class="co">## Largest absolute gradient value: 62.07895697</span>
<span class="co">## Fisher information matrix is positive definite</span>
<span class="co">## Eigenvalue range: [53.00926, 8.675704e+12]</span>
<span class="co">## Trust region iterations: 21 </span>
<span class="co">## Factor solution: admissible </span>
<span class="co">## Effective degrees of freedom: 56.75804</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alasso.fitMG</span>
<span class="co">## penfa 0.1.1 reached convergence</span>
<span class="co">## </span>
<span class="co">##   Number of observations per group:                            </span>
<span class="co">##     LEB                                                     402</span>
<span class="co">##     TAIW                                                    365</span>
<span class="co">##                                                                </span>
<span class="co">##   Estimator                                                PMLE</span>
<span class="co">##   Optimization method                              trust-region</span>
<span class="co">##   Information                                            fisher</span>
<span class="co">##   Strategy                                                 auto</span>
<span class="co">##   Number of iterations (total)                              211</span>
<span class="co">##   Number of two-steps (automatic)                             2</span>
<span class="co">##   Effective degrees of freedom                           56.758</span>
<span class="co">##                                                                </span>
<span class="co">##   Penalty functions:                                           </span>
<span class="co">##     Sparsity                                             alasso</span>
<span class="co">##     Invariance                                           alasso</span>
<span class="co">##                                                                </span>
<span class="co">## </span></code></pre></div>
<div id="summary" class="section level3">
<h3 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h3>
<p>From the <code>summary</code> of the fitted object we can notice that the automatic tuning procedure required just a couple of iterations to converge. The optimal tuning parameters are 0.00196781 for Penalty 1, 29643.229 for Penalty 2, and 0.00772724 for Penalty 3.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">alasso.fitMG</span><span class="op">)</span>
<span class="co">## penfa 0.1.1 reached convergence</span>
<span class="co">## </span>
<span class="co">##   Number of observations per group:                            </span>
<span class="co">##     LEB                                                     402</span>
<span class="co">##     TAIW                                                    365</span>
<span class="co">##   Number of groups                                            2</span>
<span class="co">##   Number of observed variables                               12</span>
<span class="co">##   Number of latent factors                                    2</span>
<span class="co">##                                                                </span>
<span class="co">##   Estimator                                                PMLE</span>
<span class="co">##   Optimization method                              trust-region</span>
<span class="co">##   Information                                            fisher</span>
<span class="co">##   Strategy                                                 auto</span>
<span class="co">##   Number of iterations (total)                              211</span>
<span class="co">##   Number of two-steps (automatic)                             2</span>
<span class="co">##   Influence factor                                            4</span>
<span class="co">##   Number of parameters:                                        </span>
<span class="co">##     Free                                                     34</span>
<span class="co">##     Penalized                                                60</span>
<span class="co">##   Effective degrees of freedom                           56.758</span>
<span class="co">##   GIC                                                 17096.153</span>
<span class="co">##   GBIC                                                17359.652</span>
<span class="co">##                                                                </span>
<span class="co">##   Penalty functions:                                           </span>
<span class="co">##     Sparsity                                             alasso</span>
<span class="co">##     Invariance                                           alasso</span>
<span class="co">##                                                                </span>
<span class="co">##   Additional tuning parameter                                  </span>
<span class="co">##     alasso                                                    1</span>
<span class="co">##                                                                </span>
<span class="co">##   Optimal tuning parameters:                                   </span>
<span class="co">##     Sparsity                                                   </span>
<span class="co">##      - Factor loadings                                    0.002</span>
<span class="co">##     Invariance                                                 </span>
<span class="co">##      - Factor loadings                                29643.229</span>
<span class="co">##      - Intercepts                                         0.008</span>
<span class="co">##                                                                </span>
<span class="co">## </span>
<span class="co">## Parameter Estimates:</span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## Group 1 [LEB]:</span>
<span class="co">## </span>
<span class="co">## Latent Variables:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##   help =~                                                      </span>
<span class="co">##     h1             fixed       1.000             1.000    1.000</span>
<span class="co">##     h2               pen       1.103    0.039    1.027    1.180</span>
<span class="co">##     h3               pen       0.996    0.040    0.917    1.076</span>
<span class="co">##     h4               pen       1.196    0.050    1.099    1.294</span>
<span class="co">##     h5               pen       1.106    0.038    1.031    1.181</span>
<span class="co">##     h6               pen       1.084    0.051    0.984    1.185</span>
<span class="co">##     h7               pen       0.742    0.065    0.614    0.870</span>
<span class="co">##     v1             fixed       0.000             0.000    0.000</span>
<span class="co">##     v2               pen       0.000                           </span>
<span class="co">##     v3               pen       0.000                           </span>
<span class="co">##     v4               pen       0.000                           </span>
<span class="co">##     v5               pen      -0.000                           </span>
<span class="co">##   voice =~                                                     </span>
<span class="co">##     h1             fixed       0.000             0.000    0.000</span>
<span class="co">##     h2               pen      -0.000                           </span>
<span class="co">##     h3               pen       0.000                           </span>
<span class="co">##     h4               pen      -0.038                           </span>
<span class="co">##     h5               pen       0.000                           </span>
<span class="co">##     h6               pen       0.044                           </span>
<span class="co">##     h7               pen       0.336    0.056    0.225    0.446</span>
<span class="co">##     v1             fixed       1.000             1.000    1.000</span>
<span class="co">##     v2               pen       1.015    0.028    0.960    1.070</span>
<span class="co">##     v3               pen       0.977    0.029    0.920    1.034</span>
<span class="co">##     v4               pen       0.977    0.029    0.920    1.034</span>
<span class="co">##     v5               pen       0.932    0.030    0.873    0.991</span>
<span class="co">## </span>
<span class="co">## Covariances:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##   help ~~                                                      </span>
<span class="co">##     voice           free       0.759    0.062    0.637    0.882</span>
<span class="co">## </span>
<span class="co">## Intercepts:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##    .h2               pen      -0.012    0.031   -0.073    0.049</span>
<span class="co">##    .h3               pen      -0.001    0.032   -0.062    0.061</span>
<span class="co">##    .h4               pen      -0.058    0.033   -0.122    0.007</span>
<span class="co">##    .h5               pen       0.024    0.031   -0.037    0.084</span>
<span class="co">##    .h6               pen       0.003    0.029   -0.055    0.060</span>
<span class="co">##    .h7               pen      -0.004    0.025   -0.054    0.045</span>
<span class="co">##    .v2               pen      -0.022    0.026   -0.072    0.029</span>
<span class="co">##    .v3               pen      -0.001    0.025   -0.050    0.048</span>
<span class="co">##    .v4               pen      -0.001    0.025   -0.050    0.048</span>
<span class="co">##    .v5               pen       0.004    0.026   -0.047    0.055</span>
<span class="co">##     help            free       0.092    0.049   -0.005    0.189</span>
<span class="co">##     voice           free       0.148    0.051    0.048    0.248</span>
<span class="co">##    .h1             fixed       0.000             0.000    0.000</span>
<span class="co">##    .v1             fixed       0.000             0.000    0.000</span>
<span class="co">## </span>
<span class="co">## Variances:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##    .h1              free       0.382    0.029    0.326    0.438</span>
<span class="co">##    .h2              free       0.213    0.017    0.180    0.247</span>
<span class="co">##    .h3              free       0.344    0.026    0.293    0.395</span>
<span class="co">##    .h4              free       0.126    0.012    0.103    0.150</span>
<span class="co">##    .h5              free       0.162    0.014    0.135    0.189</span>
<span class="co">##    .h6              free       0.164    0.014    0.137    0.191</span>
<span class="co">##    .h7              free       0.210    0.016    0.178    0.241</span>
<span class="co">##    .v1              free       0.176    0.016    0.145    0.208</span>
<span class="co">##    .v2              free       0.207    0.018    0.171    0.242</span>
<span class="co">##    .v3              free       0.250    0.021    0.209    0.290</span>
<span class="co">##    .v4              free       0.259    0.021    0.217    0.300</span>
<span class="co">##    .v5              free       0.290    0.023    0.245    0.335</span>
<span class="co">##     help            free       0.753    0.069    0.617    0.889</span>
<span class="co">##     voice           free       0.911    0.074    0.766    1.056</span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## Group 2 [TAIW]:</span>
<span class="co">## </span>
<span class="co">## Latent Variables:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##   help =~                                                      </span>
<span class="co">##     h1             fixed       1.000             1.000    1.000</span>
<span class="co">##     h2               pen       1.103    0.039    1.027    1.180</span>
<span class="co">##     h3               pen       0.996    0.040    0.917    1.076</span>
<span class="co">##     h4               pen       1.196    0.050    1.099    1.294</span>
<span class="co">##     h5               pen       1.106    0.038    1.031    1.181</span>
<span class="co">##     h6               pen       1.084    0.051    0.984    1.185</span>
<span class="co">##     h7               pen       0.742    0.065    0.614    0.870</span>
<span class="co">##     v1             fixed       0.000             0.000    0.000</span>
<span class="co">##     v2               pen       0.000                           </span>
<span class="co">##     v3               pen       0.000                           </span>
<span class="co">##     v4               pen       0.000                           </span>
<span class="co">##     v5               pen      -0.000                           </span>
<span class="co">##   voice =~                                                     </span>
<span class="co">##     h1             fixed       0.000             0.000    0.000</span>
<span class="co">##     h2               pen      -0.000                           </span>
<span class="co">##     h3               pen       0.000                           </span>
<span class="co">##     h4               pen      -0.038                           </span>
<span class="co">##     h5               pen       0.000                           </span>
<span class="co">##     h6               pen       0.044                           </span>
<span class="co">##     h7               pen       0.336    0.056    0.225    0.446</span>
<span class="co">##     v1             fixed       1.000             1.000    1.000</span>
<span class="co">##     v2               pen       1.015    0.028    0.960    1.070</span>
<span class="co">##     v3               pen       0.977    0.029    0.920    1.034</span>
<span class="co">##     v4               pen       0.977    0.029    0.920    1.034</span>
<span class="co">##     v5               pen       0.932    0.030    0.873    0.991</span>
<span class="co">## </span>
<span class="co">## Covariances:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##   help ~~                                                      </span>
<span class="co">##     voice           free       0.428    0.039    0.351    0.505</span>
<span class="co">## </span>
<span class="co">## Intercepts:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##    .h2               pen       0.008    0.032   -0.054    0.070</span>
<span class="co">##    .h3               pen      -0.001    0.032   -0.062    0.061</span>
<span class="co">##    .h4               pen       0.058    0.036   -0.013    0.129</span>
<span class="co">##    .h5               pen      -0.012    0.032   -0.075    0.051</span>
<span class="co">##    .h6               pen       0.003    0.029   -0.055    0.060</span>
<span class="co">##    .h7               pen      -0.004    0.025   -0.054    0.046</span>
<span class="co">##    .v2               pen       0.022    0.027   -0.030    0.075</span>
<span class="co">##    .v3               pen      -0.001    0.025   -0.050    0.048</span>
<span class="co">##    .v4               pen      -0.001    0.025   -0.050    0.048</span>
<span class="co">##    .v5               pen       0.002    0.026   -0.050    0.053</span>
<span class="co">##     help            free      -0.101    0.043   -0.186   -0.017</span>
<span class="co">##     voice           free      -0.161    0.045   -0.249   -0.074</span>
<span class="co">##    .h1             fixed       0.000             0.000    0.000</span>
<span class="co">##    .v1             fixed       0.000             0.000    0.000</span>
<span class="co">## </span>
<span class="co">## Variances:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##    .h1              free       0.407    0.033    0.343    0.471</span>
<span class="co">##    .h2              free       0.267    0.023    0.222    0.312</span>
<span class="co">##    .h3              free       0.411    0.033    0.346    0.476</span>
<span class="co">##    .h4              free       0.240    0.022    0.197    0.283</span>
<span class="co">##    .h5              free       0.303    0.026    0.253    0.354</span>
<span class="co">##    .h6              free       0.237    0.021    0.196    0.278</span>
<span class="co">##    .h7              free       0.321    0.026    0.270    0.371</span>
<span class="co">##    .v1              free       0.318    0.027    0.265    0.372</span>
<span class="co">##    .v2              free       0.208    0.020    0.169    0.247</span>
<span class="co">##    .v3              free       0.272    0.024    0.225    0.319</span>
<span class="co">##    .v4              free       0.261    0.023    0.215    0.306</span>
<span class="co">##    .v5              free       0.361    0.030    0.302    0.419</span>
<span class="co">##     help            free       0.461    0.045    0.373    0.549</span>
<span class="co">##     voice           free       0.568    0.051    0.469    0.668</span></code></pre></div>
<p>The estimated parameters can be inspected in matrix-form through the <code>penfaOut</code> function. The <code>which</code> argument allows to extract the elements of interest. The resulting loading matrices are sparse and equivalent across groups (as demonstrated by the very large value for the second tuning parameter).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/penfaOut.html">penfaOut</a></span><span class="op">(</span><span class="va">alasso.fitMG</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lambda"</span>, <span class="st">"tau"</span><span class="op">)</span><span class="op">)</span>
<span class="co">## $lambda</span>
<span class="co">##     help  voice</span>
<span class="co">## h1 1.000  0.000</span>
<span class="co">## h2 1.103  0.000</span>
<span class="co">## h3 0.996  0.000</span>
<span class="co">## h4 1.196 -0.038</span>
<span class="co">## h5 1.106  0.000</span>
<span class="co">## h6 1.084  0.044</span>
<span class="co">## h7 0.742  0.336</span>
<span class="co">## v1 0.000  1.000</span>
<span class="co">## v2 0.000  1.015</span>
<span class="co">## v3 0.000  0.977</span>
<span class="co">## v4 0.000  0.977</span>
<span class="co">## v5 0.000  0.932</span>
<span class="co">## </span>
<span class="co">## $tau</span>
<span class="co">##    intercept</span>
<span class="co">## h1     0.000</span>
<span class="co">## h2    -0.012</span>
<span class="co">## h3    -0.001</span>
<span class="co">## h4    -0.058</span>
<span class="co">## h5     0.024</span>
<span class="co">## h6     0.003</span>
<span class="co">## h7    -0.004</span>
<span class="co">## v1     0.000</span>
<span class="co">## v2    -0.022</span>
<span class="co">## v3    -0.001</span>
<span class="co">## v4    -0.001</span>
<span class="co">## v5     0.004</span>
<span class="co">## </span>
<span class="co">## $lambda</span>
<span class="co">##     help  voice</span>
<span class="co">## h1 1.000  0.000</span>
<span class="co">## h2 1.103  0.000</span>
<span class="co">## h3 0.996  0.000</span>
<span class="co">## h4 1.196 -0.038</span>
<span class="co">## h5 1.106  0.000</span>
<span class="co">## h6 1.084  0.044</span>
<span class="co">## h7 0.742  0.336</span>
<span class="co">## v1 0.000  1.000</span>
<span class="co">## v2 0.000  1.015</span>
<span class="co">## v3 0.000  0.977</span>
<span class="co">## v4 0.000  0.977</span>
<span class="co">## v5 0.000  0.932</span>
<span class="co">## </span>
<span class="co">## $tau</span>
<span class="co">##    intercept</span>
<span class="co">## h1     0.000</span>
<span class="co">## h2     0.008</span>
<span class="co">## h3    -0.001</span>
<span class="co">## h4     0.058</span>
<span class="co">## h5    -0.012</span>
<span class="co">## h6     0.003</span>
<span class="co">## h7    -0.004</span>
<span class="co">## v1     0.000</span>
<span class="co">## v2     0.022</span>
<span class="co">## v3    -0.001</span>
<span class="co">## v4    -0.001</span>
<span class="co">## v5     0.002</span></code></pre></div>
</div>
<div id="effective-degrees-of-freedom" class="section level3">
<h3 class="hasAnchor">
<a href="#effective-degrees-of-freedom" class="anchor"></a>Effective degrees of freedom</h3>
<p>The number of <em>edf</em> of this penalized model is 56.76, which is a fractional number, and is the sum of the contributions from the <em>edf</em> of each model parameter. Each <strong>edf</strong> quantifies the impact of the three penalties on each parameter. Parameters unaffected by the penalization have an <em>edf</em> equal to 1.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alasso.fitMG</span><span class="op">@</span><span class="va">Inference</span><span class="op">$</span><span class="va">edf.single</span></code></pre></div>
<pre><code>##        help=~h2        help=~h3        help=~h4        help=~h5        help=~h6 
##           0.694           0.684           0.740           0.756           0.702 
##        help=~h7        help=~v2        help=~v3        help=~v4        help=~v5 
##           0.676           0.001           0.001           0.000           0.001 
##       voice=~h2       voice=~h3       voice=~h4       voice=~h5       voice=~h6 
##           0.000           0.000           0.168           0.000           0.219 
##       voice=~h7       voice=~v2       voice=~v3       voice=~v4       voice=~v5 
##           0.584           0.679           0.681           0.668           0.698 
##            h2~1            h3~1            h4~1            h5~1            h6~1 
##           0.627           0.564           0.875           0.711           0.594 
##            h7~1            v2~1            v3~1            v4~1            v5~1 
##           0.617           0.689           0.569           0.554           0.594 
##          help~1         voice~1          h1~~h1          h2~~h2          h3~~h3 
##           1.000           1.000           1.000           1.000           1.000 
##          h4~~h4          h5~~h5          h6~~h6          h7~~h7          v1~~v1 
##           1.000           1.000           1.000           1.000           1.000 
##          v2~~v2          v3~~v3          v4~~v4          v5~~v5      help~~help 
##           1.000           1.000           1.000           1.000           1.000 
##    voice~~voice     help~~voice     help=~h2.g2     help=~h3.g2     help=~h4.g2 
##           1.000           1.000           0.303           0.311           0.255 
##     help=~h5.g2     help=~h6.g2     help=~h7.g2     help=~v2.g2     help=~v3.g2 
##           0.241           0.291           0.299           0.001           0.001 
##     help=~v4.g2     help=~v5.g2    voice=~h2.g2    voice=~h3.g2    voice=~h4.g2 
##           0.000           0.000           0.000           0.000           0.086 
##    voice=~h5.g2    voice=~h6.g2    voice=~h7.g2    voice=~v2.g2    voice=~v3.g2 
##           0.000           0.138           0.335           0.318           0.316 
##    voice=~v4.g2    voice=~v5.g2         h2~1.g2         h3~1.g2         h4~1.g2 
##           0.329           0.299           0.505           0.436           0.780 
##         h5~1.g2         h6~1.g2         h7~1.g2         v2~1.g2         v3~1.g2 
##           0.479           0.406           0.384           0.604           0.431 
##         v4~1.g2         v5~1.g2       help~1.g2      voice~1.g2       h1~~h1.g2 
##           0.446           0.417           1.000           1.000           1.000 
##       h2~~h2.g2       h3~~h3.g2       h4~~h4.g2       h5~~h5.g2       h6~~h6.g2 
##           1.000           1.000           1.000           1.000           1.000 
##       h7~~h7.g2       v1~~v1.g2       v2~~v2.g2       v3~~v3.g2       v4~~v4.g2 
##           1.000           1.000           1.000           1.000           1.000 
##       v5~~v5.g2   help~~help.g2 voice~~voice.g2  help~~voice.g2 
##           1.000           1.000           1.000           1.000</code></pre>
</div>
<div id="implied-moments" class="section level3">
<h3 class="hasAnchor">
<a href="#implied-moments" class="anchor"></a>Implied moments</h3>
<p>The group-specific implied moments (the covariance matrix and the mean vector) can be found via the <code>fitted</code> method.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">implied</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">alasso.fitMG</span><span class="op">)</span>
<span class="va">implied</span>
<span class="co">## $LEB</span>
<span class="co">## $LEB$cov</span>
<span class="co">##    h1    h2    h3    h4    h5    h6    h7    v1    v2    v3    v4    v5   </span>
<span class="co">## h1 1.135                                                                  </span>
<span class="co">## h2 0.831 1.130                                                            </span>
<span class="co">## h3 0.750 0.828 1.092                                                      </span>
<span class="co">## h4 0.872 0.963 0.869 1.137                                                </span>
<span class="co">## h5 0.833 0.919 0.830 0.965 1.083                                          </span>
<span class="co">## h6 0.850 0.938 0.847 0.985 0.940 1.124                                    </span>
<span class="co">## h7 0.814 0.898 0.811 0.941 0.900 0.920 1.105                              </span>
<span class="co">## v1 0.759 0.838 0.756 0.874 0.840 0.863 0.869 1.088                        </span>
<span class="co">## v2 0.771 0.850 0.768 0.887 0.852 0.876 0.882 0.925 1.145                  </span>
<span class="co">## v3 0.742 0.819 0.739 0.854 0.820 0.844 0.849 0.890 0.904 1.120            </span>
<span class="co">## v4 0.742 0.818 0.739 0.854 0.820 0.844 0.849 0.890 0.904 0.870 1.128      </span>
<span class="co">## v5 0.708 0.781 0.705 0.815 0.783 0.805 0.810 0.849 0.862 0.830 0.830 1.082</span>
<span class="co">## </span>
<span class="co">## $LEB$mean</span>
<span class="co">##    h1    h2    h3    h4    h5    h6    h7    v1    v2    v3    v4    v5 </span>
<span class="co">## 0.092 0.090 0.091 0.047 0.126 0.109 0.114 0.148 0.128 0.144 0.144 0.142 </span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## $TAIW</span>
<span class="co">## $TAIW$cov</span>
<span class="co">##    h1    h2    h3    h4    h5    h6    h7    v1    v2    v3    v4    v5   </span>
<span class="co">## h1 0.868                                                                  </span>
<span class="co">## h2 0.509 0.828                                                            </span>
<span class="co">## h3 0.459 0.507 0.869                                                      </span>
<span class="co">## h4 0.535 0.591 0.533 0.862                                                </span>
<span class="co">## h5 0.510 0.562 0.508 0.592 0.867                                          </span>
<span class="co">## h6 0.519 0.572 0.517 0.602 0.574 0.821                                    </span>
<span class="co">## h7 0.486 0.536 0.484 0.562 0.537 0.549 0.851                              </span>
<span class="co">## v1 0.428 0.472 0.427 0.491 0.473 0.489 0.508 0.887                        </span>
<span class="co">## v2 0.435 0.480 0.433 0.498 0.481 0.497 0.516 0.577 0.794                  </span>
<span class="co">## v3 0.418 0.462 0.417 0.480 0.463 0.478 0.497 0.555 0.564 0.815            </span>
<span class="co">## v4 0.418 0.462 0.417 0.479 0.462 0.478 0.497 0.555 0.564 0.543 0.803      </span>
<span class="co">## v5 0.399 0.440 0.398 0.457 0.441 0.456 0.474 0.530 0.538 0.518 0.518 0.855</span>
<span class="co">## </span>
<span class="co">## $TAIW$mean</span>
<span class="co">##     h1     h2     h3     h4     h5     h6     h7     v1     v2     v3     v4     v5 </span>
<span class="co">## -0.101 -0.103 -0.101 -0.057 -0.124 -0.114 -0.133 -0.161 -0.142 -0.159 -0.158 -0.149</span></code></pre></div>
</div>
<div id="penalty-matrices" class="section level3">
<h3 class="hasAnchor">
<a href="#penalty-matrices" class="anchor"></a>Penalty matrices</h3>
<p>The complete penalty matrix is stored in <code>alasso.fit@Penalize@Sh.info$S.h</code>, but it can be easily extracted via the <code>penmat</code> function. This matrix is the sum of the penalty matrices for Penalty 1 (<code>sparsity.penmat</code>), Penalty 2 (<code>loadinvariance.penmat</code>), and Penalty 3 (<code>intinvariance.penmat</code>). Unique variances, factor (co)variances and factor means were not affected by the penalization, so their entries in the penalty matrices are equal to zero.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">full.penmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/penmat.html">penmat</a></span><span class="op">(</span><span class="va">alasso.fitMG</span><span class="op">)</span></code></pre></div>
<p>The above penalty matrix is the sum of the following three individuals penalty matrices.</p>
<div id="sparsity" class="section level4">
<h4 class="hasAnchor">
<a href="#sparsity" class="anchor"></a>Sparsity</h4>
<p>This penalty matrix shrinks the small factor loadings of each group to zero. Apart from the group loadings, all the remaining entries of the penalty matrix are equal to zero.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sparsity.penmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/penmat.html">penmat</a></span><span class="op">(</span><span class="va">alasso.fitMG</span>, type <span class="op">=</span> <span class="st">"shrink"</span>, which <span class="op">=</span> <span class="st">"lambda"</span><span class="op">)</span></code></pre></div>
</div>
<div id="loading-invariance" class="section level4">
<h4 class="hasAnchor">
<a href="#loading-invariance" class="anchor"></a>Loading invariance</h4>
<p>This penalty matrix shrinks the pairwise group differences of the factor loadings to zero.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">loadinvariance.penmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/penmat.html">penmat</a></span><span class="op">(</span><span class="va">alasso.fitMG</span>, type <span class="op">=</span> <span class="st">"diff"</span>, which <span class="op">=</span> <span class="st">"lambda"</span><span class="op">)</span></code></pre></div>
</div>
<div id="intercept-invariance" class="section level4">
<h4 class="hasAnchor">
<a href="#intercept-invariance" class="anchor"></a>Intercept invariance</h4>
<p>This penalty matrix shrinks the pairwise group differences of the intercepts to zero.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">intinvariance.penmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/penmat.html">penmat</a></span><span class="op">(</span><span class="va">alasso.fitMG</span>, type <span class="op">=</span> <span class="st">"diff"</span>, which <span class="op">=</span> <span class="st">"tau"</span><span class="op">)</span></code></pre></div>
<p>See <a href="https://egeminiani.github.io/penfa/articles/articles/plotting-penalty-matrix.html">“plotting-penalty-matrix”</a> for details on how to produce interactive plots of the above penalty matrices.</p>
</div>
</div>
<div id="factor-scores" class="section level3">
<h3 class="hasAnchor">
<a href="#factor-scores" class="anchor"></a>Factor scores</h3>
<p>Lastly, group-specific factor scores can be calculated via the <code>penfaPredict</code> function. The argument <code>assemble = TRUE</code> allows to assemble the factor scores from each group in a single data frame with a group column.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fscoresMG</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/penfaPredict.html">penfaPredict</a></span><span class="op">(</span><span class="va">alasso.fitMG</span>, assemble <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">fscoresMG</span><span class="op">)</span>
<span class="co">##          help      voice country</span>
<span class="co">## 1 -0.33313708  0.1084453     LEB</span>
<span class="co">## 2 -0.04529539 -0.3208210     LEB</span>
<span class="co">## 3  0.45706110  0.6149927     LEB</span>
<span class="co">## 4  0.10698654  0.5475679     LEB</span>
<span class="co">## 5  0.29863211  0.7514275     LEB</span>
<span class="co">## 6 -0.50629431 -0.4367660     LEB</span></code></pre></div>
</div>
</div>
<div id="r-session" class="section level2">
<h2 class="hasAnchor">
<a href="#r-session" class="anchor"></a>R Session</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">## R version 4.1.0 (2021-05-18)</span>
<span class="co">## Platform: x86_64-apple-darwin17.0 (64-bit)</span>
<span class="co">## Running under: macOS Catalina 10.15.7</span>
<span class="co">## </span>
<span class="co">## Matrix products: default</span>
<span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.dylib</span>
<span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib</span>
<span class="co">## </span>
<span class="co">## locale:</span>
<span class="co">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span>
<span class="co">## </span>
<span class="co">## attached base packages:</span>
<span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">## </span>
<span class="co">## other attached packages:</span>
<span class="co">## [1] penfa_0.1.1</span>
<span class="co">## </span>
<span class="co">## loaded via a namespace (and not attached):</span>
<span class="co">##  [1] VineCopula_2.4.2    magic_1.5-9         sfsmisc_1.1-11     </span>
<span class="co">##  [4] VGAM_1.1-5          splines_4.1.0       tmvnsim_1.0-2      </span>
<span class="co">##  [7] distr_2.8.0         stats4_4.1.0        yaml_2.2.1         </span>
<span class="co">## [10] numDeriv_2016.8-1.1 pillar_1.6.1        lattice_0.20-44    </span>
<span class="co">## [13] startupmsg_0.9.6    glue_1.4.2          digest_0.6.27      </span>
<span class="co">## [16] colorspace_2.0-2    htmltools_0.5.1.1   Matrix_1.3-3       </span>
<span class="co">## [19] survey_4.1-1        psych_2.1.6         pcaPP_1.9-74       </span>
<span class="co">## [22] pkgconfig_2.0.3     ismev_1.42          purrr_0.3.4        </span>
<span class="co">## [25] GJRM_0.2-4          mvtnorm_1.1-2       scales_1.1.1       </span>
<span class="co">## [28] copula_1.0-1        tibble_3.1.2        ADGofTest_0.3      </span>
<span class="co">## [31] gmp_0.6-2           mgcv_1.8-35         generics_0.1.0     </span>
<span class="co">## [34] ggplot2_3.3.5       ellipsis_0.3.2      cachem_1.0.5       </span>
<span class="co">## [37] distrEx_2.8.0       Rmpfr_0.8-4         mnormt_2.0.2       </span>
<span class="co">## [40] survival_3.2-11     magrittr_2.0.1      crayon_1.4.1       </span>
<span class="co">## [43] memoise_2.0.0       evaluate_0.14       fs_1.5.0           </span>
<span class="co">## [46] fansi_0.5.0         nlme_3.1-152        MASS_7.3-54        </span>
<span class="co">## [49] gsl_2.1-6           textshaping_0.3.5   tools_4.1.0        </span>
<span class="co">## [52] mitools_2.4         lifecycle_1.0.0     pspline_1.0-18     </span>
<span class="co">## [55] matrixStats_0.59.0  stringr_1.4.0       trust_0.1-8        </span>
<span class="co">## [58] munsell_0.5.0       stabledist_0.7-1    scam_1.2-11        </span>
<span class="co">## [61] gamlss.dist_5.3-2   compiler_4.1.0      pkgdown_1.6.1      </span>
<span class="co">## [64] evd_2.3-3           systemfonts_1.0.2   rlang_0.4.11       </span>
<span class="co">## [67] grid_4.1.0          trustOptim_0.8.6.2  rmarkdown_2.9      </span>
<span class="co">## [70] gtable_0.3.0        abind_1.4-5         DBI_1.1.1          </span>
<span class="co">## [73] R6_2.5.0            knitr_1.33          dplyr_1.0.7        </span>
<span class="co">## [76] fastmap_1.1.0       utf8_1.2.1          rprojroot_2.0.2    </span>
<span class="co">## [79] ragg_1.1.3          desc_1.3.0          matrixcalc_1.0-4   </span>
<span class="co">## [82] stringi_1.7.3       parallel_4.1.0      Rcpp_1.0.7         </span>
<span class="co">## [85] vctrs_0.3.8         tidyselect_1.1.1    xfun_0.24</span></code></pre></div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<ul>
<li><p>Fischer, R., Ferreira, M. C., Van Meurs, N. et al. (2019). “Does Organizational Formalization Facilitate Voice and Helping Organizational Citizenship Behaviors? It Depends on (National) Uncertainty Norms.” Journal of International Business Studies, 50(1), 125-134. <a href="https://doi.org/10.1057/s41267-017-0132-6">https://doi.org/10.1057/s41267-017-0132-6</a></p></li>
<li><p>Fischer, R., &amp; Karl, J. A. (2019). “A Primer to (Cross-Cultural) Multi-Group Invariance Testing Possibilities in R.” Frontiers in psychology, 10, 1507. <a href="https://doi.org/10.3389/fpsyg.2019.01507">https://doi.org/10.3389/fpsyg.2019.01507</a></p></li>
<li><p>Geminiani, E., Marra, G., &amp; Moustaki, I. (2021). “Single- and Multiple-Group Penalized Factor Analysis: A Trust-Region Algorithm Approach with Integrated Automatic Multiple Tuning Parameter Selection.” Psychometrika, 86(1), 65-95. <a href="https://doi.org/10.1007/s11336-021-09751-8">https://doi.org/10.1007/s11336-021-09751-8</a></p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Elena Geminiani, Giampiero Marra, Irini Moustaki.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
