<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Penalized Factor Analysis: grid search • penfa</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/readable/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Penalized Factor Analysis: grid search">
<meta property="og:description" content="penfa">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-PQWMEC6S1Z"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PQWMEC6S1Z');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">penfa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/automatic-tuning-selection.html">Penalized Factor Analysis</a>
    </li>
    <li>
      <a href="../articles/grid-search-tuning-selection.html">Penalized Factor Analysis: grid search</a>
    </li>
    <li>
      <a href="../articles/multiple-group-analysis.html">Penalized Multiple-Group Factor Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/egeminiani/penfa/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="grid-search-tuning-selection_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="grid-search-tuning-selection_files/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="grid-search-tuning-selection_files/plotly-binding-4.9.4.1/plotly.js"></script><script src="grid-search-tuning-selection_files/typedarray-0.1/typedarray.min.js"></script><script src="grid-search-tuning-selection_files/jquery-3.5.1/jquery.min.js"></script><link href="grid-search-tuning-selection_files/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="grid-search-tuning-selection_files/crosstalk-1.1.1/js/crosstalk.min.js"></script><link href="grid-search-tuning-selection_files/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="grid-search-tuning-selection_files/plotly-main-1.57.1/plotly-latest.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Penalized Factor Analysis: grid search</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/egeminiani/penfa/blob/master/vignettes/grid-search-tuning-selection.Rmd"><code>vignettes/grid-search-tuning-selection.Rmd</code></a></small>
      <div class="hidden name"><code>grid-search-tuning-selection.Rmd</code></div>

    </div>

    
    
<style type="text/css">
pre {
  max-height: 600px;
  overflow-y: auto;
}

pre[class] {
  max-height: 600px;
}
</style>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p><strong>Aim</strong>. This vignette shows how to fit a penalized factor analysis model with the scad and mcp penalties using the routines in the <code>penfa</code> package. The employed penalty is aimed at encouraging sparsity in the factor loading matrix. Since the scad and mcp penalties cannot be used with the automatic tuning procedure (see Geminiani et al., 2021 for details), the optimal tuning parameter will be found through grid searches.</p>
<p><strong>Data</strong>. For illustration purposes, we use the cross-cultural data set <code>ccdata</code> containing the standardized ratings to 12 items concerning organizational citizenship behavior. Employees from different countries were asked to rate their attitudes towards helping other employees and giving suggestions for improved work conditions. The items are thought to measure two latent factors: <strong>help</strong>, defined by the first seven items (<code>h1</code> to <code>h7</code>), and <strong>voice</strong>, represented by the last five items (<code>v1</code> to <code>v5</code>). See <code><a href="../reference/ccdata.html">?ccdata</a></code> for details.</p>
<p>This data set is a standardized version of the one in the <a href="https://github.com/Jo-Karl/ccpsyc/"><code>ccpsyc</code></a> package, and only considers employees from Lebanon and Taiwan (i.e., <code>"LEB"</code>, <code>"TAIW"</code>). This vignette is meant as a demo of the capabilities of <code>penfa</code>; please refer to Fischer et al. (2019) and Fischer and Karl (2019) for a description and analysis of these data.</p>
<p>Let us load and inspect <code>ccdata</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/egeminiani/penfa">penfa</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">ccdata</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ccdata</span><span class="op">)</span>
<span class="co">##    country                h1                 h2                h3                 h4         </span>
<span class="co">##  Length:767         Min.   :-2.62004   Min.   :-2.9034   Min.   :-2.63082   Min.   :-3.0441  </span>
<span class="co">##  Class :character   1st Qu.:-0.69516   1st Qu.:-0.2163   1st Qu.:-0.70356   1st Qu.:-0.2720  </span>
<span class="co">##  Mode  :character   Median :-0.05354   Median : 0.4554   Median :-0.06114   Median : 0.4211  </span>
<span class="co">##                     Mean   : 0.00000   Mean   : 0.0000   Mean   : 0.00000   Mean   : 0.0000  </span>
<span class="co">##                     3rd Qu.: 0.58809   3rd Qu.: 0.4554   3rd Qu.: 0.58128   3rd Qu.: 0.4211  </span>
<span class="co">##                     Max.   : 1.22971   Max.   : 1.1272   Max.   : 1.22370   Max.   : 1.1141  </span>
<span class="co">##        h5                h6                h7                v1                  v2           </span>
<span class="co">##  Min.   :-2.9105   Min.   :-2.9541   Min.   :-2.8364   Min.   :-2.627694   Min.   :-2.674430  </span>
<span class="co">##  1st Qu.:-0.8662   1st Qu.:-0.9092   1st Qu.:-0.7860   1st Qu.:-0.660770   1st Qu.:-0.671219  </span>
<span class="co">##  Median : 0.4966   Median : 0.4541   Median :-0.1025   Median :-0.005129   Median :-0.003482  </span>
<span class="co">##  Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.000000   Mean   : 0.000000  </span>
<span class="co">##  3rd Qu.: 0.4966   3rd Qu.: 0.4541   3rd Qu.: 0.5810   3rd Qu.: 0.650512   3rd Qu.: 0.664255  </span>
<span class="co">##  Max.   : 1.1781   Max.   : 1.1358   Max.   : 1.2645   Max.   : 1.306154   Max.   : 1.331992  </span>
<span class="co">##        v3                 v4                 v5          </span>
<span class="co">##  Min.   :-2.65214   Min.   :-2.65722   Min.   :-2.51971  </span>
<span class="co">##  1st Qu.:-0.68800   1st Qu.:-0.68041   1st Qu.:-0.61127  </span>
<span class="co">##  Median :-0.03329   Median :-0.02148   Median : 0.02488  </span>
<span class="co">##  Mean   : 0.00000   Mean   : 0.00000   Mean   : 0.00000  </span>
<span class="co">##  3rd Qu.: 0.62142   3rd Qu.: 0.63746   3rd Qu.: 0.66103  </span>
<span class="co">##  Max.   : 1.27613   Max.   : 1.29639   Max.   : 1.29718</span></code></pre></div>
</div>
<div id="model-specification" class="section level2">
<h2 class="hasAnchor">
<a href="#model-specification" class="anchor"></a>Model specification</h2>
<p>Before fitting the model, we need to write a model syntax describing the relationships between the items and the latent factors. To facilitate its formulation, the rules for the syntax specification broadly follow the ones required by <a href="https://cran.r-project.org/web/packages/lavaan/">lavaan</a>. The syntax must be enclosed in single quotes <code>' '</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">syntax</span> <span class="op">=</span> <span class="st">'help  =~   h1 + h2 + h3 + h4 + h5 + h6 + h7 + 0*v1 + v2 + v3 + v4 + v5
          voice =~ 0*h1 + h2 + h3 + h4 + h5 + h6 + h7 +   v1 + v2 + v3 + v4 + v5'</span></code></pre></div>
<p>The factors <code>help</code> and <code>voice</code> appear on the left-hand side, whereas the observed variables on the left-hand side. Following the rationale in Geminiani et al. (2021), we only specify the minimum number of identification constraints. We are setting the scales of the factors by fixing their factor variances to 1. This can be done in one of two ways: 1) by adding <code>'help ~~ 1*help'</code> and <code>'voice ~~ 1*voice'</code> to the syntax above; or 2) by setting the argument <code>std.lv = TRUE</code> in the fitting function (see below). To avoid rotational freedom, we fix one loading per factor to zero. Parameters can be easily fixed to user-defined values through the pre-multiplication mechanism. By default, unique variances are automatically added to the model, and the factors are allowed to correlate. These specifications can be modified by altering the syntax (see <code><a href="../reference/penfa.html">?penfa</a></code> for details on how to write the model syntax).</p>
</div>
<div id="model-fitting" class="section level2">
<h2 class="hasAnchor">
<a href="#model-fitting" class="anchor"></a>Model fitting</h2>
<p>The core of the package is given by the <code>penfa</code> function, a short form for <em>PENalized Factor Analysis</em>, that implements the framework discussed in Geminiani et al. (2021). If users decide for either the <code>scad</code> or <code>mcp</code> penalties, they need to use <code>strategy = "fixed"</code> since the automatic procedure is not feasible.</p>
<div id="scad" class="section level3">
<h3 class="hasAnchor">
<a href="#scad" class="anchor"></a>Scad</h3>
<p>We start off with the scad. In the function call, we now specify <code>pen.shrink = "scad"</code>, and we provide through the <code>eta</code> argument the fixed value of the tuning parameter to be employed during optimization (here, for instance, 0.05). The name given to the starting value (here, the factor loading matrix <code>"lambda"</code>) reflects the parameter matrix to be penalized. All of its elements are penalized, which means here that the penalization is applied to all factor loadings (except the ones fixed for identification). The scad penalty relies on an additional shape parameter, which is set by default to 3.7 (Fan and Li 2001). This value can be conveniently modified through the <code>a.scad</code> argument. See <code><a href="../reference/penfaOptions.html">?penfaOptions</a></code> for additional details on the possible options.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">scad.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/penfa.html">penfa</a></span><span class="op">(</span><span class="co">## factor model</span>
                  model  <span class="op">=</span> <span class="va">syntax</span>,
                  data   <span class="op">=</span> <span class="va">ccdata</span>,
                  std.lv <span class="op">=</span> <span class="cn">TRUE</span>,
                  <span class="co">## penalization</span>
                  pen.shrink <span class="op">=</span> <span class="st">"scad"</span>,
                  eta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shrink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lambda"</span> <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>, diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"none"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
                  <span class="co">## fixed tuning</span>
                  strategy <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Largest absolute gradient value: 27.97150845</span>
<span class="co">## Fisher information matrix is positive definite</span>
<span class="co">## Eigenvalue range: [164.74, 382028.4]</span>
<span class="co">## Trust region iterations: 24 </span>
<span class="co">## Factor solution: admissible </span>
<span class="co">## Computing VCOV ... done.</span>
<span class="co">## Effective degrees of freedom: 27.94395</span></code></pre></div>
<div id="grid-search" class="section level4">
<h4 class="hasAnchor">
<a href="#grid-search" class="anchor"></a>Grid search</h4>
<p>In order to find the optimal value of the tuning parameter, a grid search needs to be conducted, and the optimal model is the one with the lowest GBIC (Generalized Bayesian Information Criterion). For demo purposes, we use a grid of 51 values evenly spaced between 0 and 0.15. However, for accurate analyses, please consider finer grids (of at least 200 elements) with an upper bound reasonable for the data at hand.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Grid of values for tuning parameter</span>
<span class="va">eta.grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.15</span>, length.out <span class="op">=</span> <span class="fl">51</span><span class="op">)</span>

<span class="co"># Return GBIC from a converged and admissible penfa model with fixed tuning</span>
<span class="va">penfa.fixedTun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">eta</span>, <span class="va">penalty</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span>
  
  <span class="va">fitted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/penfa.html">penfa</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">syntax</span>, data <span class="op">=</span> <span class="va">ccdata</span>, 
                  std.lv <span class="op">=</span> <span class="cn">TRUE</span>, pen.shrink <span class="op">=</span> <span class="va">penalty</span>, 
                  eta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shrink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lambda"</span> <span class="op">=</span> <span class="va">eta</span><span class="op">)</span>, diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"none"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
                  strategy <span class="op">=</span> <span class="st">"fixed"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span>
  
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">fitted</span><span class="op">@</span><span class="va">Vcov</span><span class="op">$</span><span class="va">solution</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">fitted</span><span class="op">@</span><span class="va">Vcov</span><span class="op">$</span><span class="va">admissibility</span><span class="op">)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">BIC</a></span><span class="op">(</span><span class="va">fitted</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># additional penfaOptions can be passed</span>
<span class="va">GBIC.scad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">eta.grid</span>, <span class="va">penfa.fixedTun</span>, penalty <span class="op">=</span> <span class="st">"scad"</span><span class="op">)</span> </code></pre></div>
<p>We can plot <code>GBIC</code> values across the tuning values.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">optimtun.scad</span> <span class="op">&lt;-</span> <span class="va">eta.grid</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">GBIC.scad</span><span class="op">)</span><span class="op">]</span><span class="op">]</span>
  
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/plotly/reference/plot_ly.html">plot_ly</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">eta.grid</span>, y <span class="op">=</span> <span class="va">GBIC.scad</span>, type <span class="op">=</span> <span class="st">'scatter'</span>, mode <span class="op">=</span> <span class="st">'lines'</span><span class="op">)</span>
<span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/plotly/reference/layout.html">layout</a></span><span class="op">(</span><span class="va">p</span>, xaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>showline <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
               title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"GBIC values across tuning parameters"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-59c772ba9c3a7c4b20ea" style="width:576px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-59c772ba9c3a7c4b20ea">{"x":{"visdat":{"155e446f5d1a":["function () ","plotlyVisDat"]},"cur_data":"155e446f5d1a","attrs":{"155e446f5d1a":{"x":[0,0.003,0.006,0.009,0.012,0.015,0.018,0.021,0.024,0.027,0.03,0.033,0.036,0.039,0.042,0.045,0.048,0.051,0.054,0.057,0.06,0.063,0.066,0.069,0.072,0.075,0.078,0.081,0.084,0.087,0.09,0.093,0.096,0.099,0.102,0.105,0.108,0.111,0.114,0.117,0.12,0.123,0.126,0.129,0.132,0.135,0.138,0.141,0.144,0.147,0.15],"y":[17396.1792565921,17389.6012374136,17379.9066385034,17376.4933434123,17366.7044811975,17362.9101329404,17359.7359863997,17357.9478208619,17355.6179026994,17354.7787217261,17354.2846261666,17353.9725309276,17353.7606357444,17353.5986274967,17353.7553938161,17353.3260626243,17352.8052248731,17352.3055358208,17351.8159561802,17351.0772415463,17350.3711186799,17349.6894638604,17349.1586542158,17348.7143362039,17349.0346381527,17349.1580878401,17349.3188132048,17349.6555762298,17349.9538948193,17350.2351363356,17350.5012800874,17350.6679163188,17350.3123240374,17350.0606491985,17349.9086087174,17347.4089628504,17347.2129429699,17347.1602144065,17347.1311525381,17347.2659201089,17347.886544954,17348.7132813606,17349.9509746262,17349.041919505,17349.2633171875,17349.51305498,17349.7813486608,17350.5395213189,17351.0540993595,17350.9051164779,17350.8556607212],"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"showline":true,"title":[]},"title":{"text":"GBIC values across tuning parameters"},"yaxis":{"domain":[0,1],"automargin":true,"title":[]},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[0,0.003,0.006,0.009,0.012,0.015,0.018,0.021,0.024,0.027,0.03,0.033,0.036,0.039,0.042,0.045,0.048,0.051,0.054,0.057,0.06,0.063,0.066,0.069,0.072,0.075,0.078,0.081,0.084,0.087,0.09,0.093,0.096,0.099,0.102,0.105,0.108,0.111,0.114,0.117,0.12,0.123,0.126,0.129,0.132,0.135,0.138,0.141,0.144,0.147,0.15],"y":[17396.1792565921,17389.6012374136,17379.9066385034,17376.4933434123,17366.7044811975,17362.9101329404,17359.7359863997,17357.9478208619,17355.6179026994,17354.7787217261,17354.2846261666,17353.9725309276,17353.7606357444,17353.5986274967,17353.7553938161,17353.3260626243,17352.8052248731,17352.3055358208,17351.8159561802,17351.0772415463,17350.3711186799,17349.6894638604,17349.1586542158,17348.7143362039,17349.0346381527,17349.1580878401,17349.3188132048,17349.6555762298,17349.9538948193,17350.2351363356,17350.5012800874,17350.6679163188,17350.3123240374,17350.0606491985,17349.9086087174,17347.4089628504,17347.2129429699,17347.1602144065,17347.1311525381,17347.2659201089,17347.886544954,17348.7132813606,17349.9509746262,17349.041919505,17349.2633171875,17349.51305498,17349.7813486608,17350.5395213189,17351.0540993595,17350.9051164779,17350.8556607212],"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>We can ultimately fit the model with the optimal tuning parameter (here, 0.114), that is, the one generating the penalized model with the lowest GBIC. The <code>summary</code> method details information on the model characteristics, the optimization and penalization procedures as well as the parameter estimates with associated standard errors and confidence intervals. The <em>Type</em> column distinguishes between the <em>fixed</em> parameters set to specific values for identification, the <em>free</em> parameters that have been estimated through ordinary maximum likelihood, and the penalized (<em>pen</em>) parameters. The standard errors here have been computed as the square root of the inverse of the penalized Fisher information matrix (Geminiani et al., 2021). The last columns report 95% confidence intervals (CI) for the model parameters. Standard errors and CI of the penalized parameters shrunken to zero are not displayed. A different significance level can be specified through the <code>level</code> argument in the <code>summary</code> call.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">scad.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/penfa.html">penfa</a></span><span class="op">(</span><span class="co">## factor model </span>
                  model <span class="op">=</span> <span class="va">syntax</span>, 
                  data <span class="op">=</span> <span class="va">ccdata</span>, 
                  std.lv <span class="op">=</span> <span class="cn">TRUE</span>, 
                  <span class="co">## penalization</span>
                  pen.shrink <span class="op">=</span> <span class="st">"scad"</span>, 
                  <span class="co"># optimal tuning</span>
                  eta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shrink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lambda"</span> <span class="op">=</span> <span class="va">optimtun.scad</span><span class="op">)</span>, diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"none"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
                  strategy <span class="op">=</span> <span class="st">"fixed"</span>, 
                  verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">scad.fit</span><span class="op">)</span>
<span class="co">## penfa 0.0.0.9000 reached convergence</span>
<span class="co">## </span>
<span class="co">##   Number of observations                                    767</span>
<span class="co">##   Number of groups                                            1</span>
<span class="co">##   Number of observed variables                               12</span>
<span class="co">##   Number of latent factors                                    2</span>
<span class="co">##                                                                </span>
<span class="co">##   Estimator                                                PMLE</span>
<span class="co">##   Optimization method                              trust-region</span>
<span class="co">##   Information                                            fisher</span>
<span class="co">##   Strategy                                                fixed</span>
<span class="co">##   Number of iterations                                       56</span>
<span class="co">##   Number of parameters:                                        </span>
<span class="co">##     Free                                                     13</span>
<span class="co">##     Penalized                                                22</span>
<span class="co">##   Effective degrees of freedom                           26.424</span>
<span class="co">##   GIC                                                 17224.457</span>
<span class="co">##   GBIC                                                17347.131</span>
<span class="co">##                                                                </span>
<span class="co">##   Penalty function:                                            </span>
<span class="co">##     Sparsity                                               scad</span>
<span class="co">##                                                                </span>
<span class="co">##   Additional tuning parameter                                  </span>
<span class="co">##     scad                                                    3.7</span>
<span class="co">##                                                                </span>
<span class="co">##   Optimal tuning parameter:                                    </span>
<span class="co">##     Sparsity                                                   </span>
<span class="co">##      - Factor loadings                                    0.114</span>
<span class="co">##                                                                </span>
<span class="co">## </span>
<span class="co">## Parameter Estimates:</span>
<span class="co">## </span>
<span class="co">## Latent Variables:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##   help =~                                                      </span>
<span class="co">##     h1               pen       0.779    0.030    0.720    0.839</span>
<span class="co">##     h2               pen       0.875    0.029    0.818    0.931</span>
<span class="co">##     h3               pen       0.788    0.030    0.729    0.847</span>
<span class="co">##     h4               pen       0.915    0.031    0.854    0.976</span>
<span class="co">##     h5               pen       0.831    0.034    0.765    0.897</span>
<span class="co">##     h6               pen       0.812    0.036    0.740    0.883</span>
<span class="co">##     h7               pen       0.507    0.050    0.409    0.604</span>
<span class="co">##     v1             fixed       0.000             0.000    0.000</span>
<span class="co">##     v2               pen       0.000                           </span>
<span class="co">##     v3               pen       0.000                           </span>
<span class="co">##     v4               pen       0.000                           </span>
<span class="co">##     v5               pen      -0.000                           </span>
<span class="co">##   voice =~                                                     </span>
<span class="co">##     h1             fixed       0.000             0.000    0.000</span>
<span class="co">##     h2               pen      -0.002                           </span>
<span class="co">##     h3               pen       0.000                           </span>
<span class="co">##     h4               pen      -0.020                           </span>
<span class="co">##     h5               pen       0.039                           </span>
<span class="co">##     h6               pen       0.082    0.026    0.031    0.132</span>
<span class="co">##     h7               pen       0.370    0.049    0.274    0.465</span>
<span class="co">##     v1               pen       0.862    0.029    0.806    0.918</span>
<span class="co">##     v2               pen       0.881    0.028    0.826    0.937</span>
<span class="co">##     v3               pen       0.852    0.029    0.795    0.909</span>
<span class="co">##     v4               pen       0.853    0.029    0.796    0.910</span>
<span class="co">##     v5               pen       0.814    0.030    0.756    0.872</span>
<span class="co">## </span>
<span class="co">## Covariances:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##   help ~~                                                      </span>
<span class="co">##     voice           free       0.879    0.011    0.858    0.901</span>
<span class="co">## </span>
<span class="co">## Variances:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##    .h1              free       0.384    0.021    0.343    0.426</span>
<span class="co">##    .h2              free       0.231    0.014    0.203    0.258</span>
<span class="co">##    .h3              free       0.371    0.021    0.330    0.411</span>
<span class="co">##    .h4              free       0.186    0.012    0.162    0.210</span>
<span class="co">##    .h5              free       0.235    0.014    0.208    0.263</span>
<span class="co">##    .h6              free       0.201    0.012    0.177    0.225</span>
<span class="co">##    .h7              free       0.265    0.015    0.236    0.294</span>
<span class="co">##    .v1              free       0.244    0.015    0.214    0.273</span>
<span class="co">##    .v2              free       0.208    0.013    0.181    0.234</span>
<span class="co">##    .v3              free       0.261    0.016    0.230    0.292</span>
<span class="co">##    .v4              free       0.260    0.016    0.229    0.291</span>
<span class="co">##    .v5              free       0.326    0.019    0.289    0.363</span>
<span class="co">##     help           fixed       1.000             1.000    1.000</span>
<span class="co">##     voice          fixed       1.000             1.000    1.000</span></code></pre></div>
<p>The penalty matrix can be inspected and plotted as shown in <code><a href="../articles/automatic-tuning-selection.html">vignette("automatic-tuning-selection")</a></code>.</p>
</div>
<div id="implied-moments" class="section level4">
<h4 class="hasAnchor">
<a href="#implied-moments" class="anchor"></a>Implied moments</h4>
<p>The implied moments (here, the covariance matrix) can be found via the <code>fitted</code> method.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">implied</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">scad.fit</span><span class="op">)</span>
<span class="va">implied</span>
<span class="co">## $cov</span>
<span class="co">##    h1    h2    h3    h4    h5    h6    h7    v1    v2    v3    v4    v5   </span>
<span class="co">## h1 0.992                                                                  </span>
<span class="co">## h2 0.680 0.993                                                            </span>
<span class="co">## h3 0.614 0.688 0.991                                                      </span>
<span class="co">## h4 0.699 0.783 0.707 0.992                                                </span>
<span class="co">## h5 0.674 0.755 0.682 0.776 0.984                                          </span>
<span class="co">## h6 0.688 0.771 0.696 0.792 0.765 0.983                                    </span>
<span class="co">## h7 0.648 0.726 0.655 0.745 0.723 0.742 0.988                              </span>
<span class="co">## v1 0.591 0.661 0.597 0.676 0.663 0.686 0.703 0.987                        </span>
<span class="co">## v2 0.604 0.676 0.611 0.692 0.678 0.701 0.719 0.760 0.985                  </span>
<span class="co">## v3 0.584 0.654 0.590 0.669 0.656 0.678 0.695 0.735 0.751 0.987            </span>
<span class="co">## v4 0.584 0.654 0.591 0.669 0.656 0.678 0.695 0.735 0.752 0.727 0.987      </span>
<span class="co">## v5 0.558 0.624 0.564 0.639 0.626 0.647 0.663 0.702 0.717 0.693 0.694 0.989</span></code></pre></div>
</div>
</div>
<div id="factor-scores" class="section level3">
<h3 class="hasAnchor">
<a href="#factor-scores" class="anchor"></a>Factor scores</h3>
<p>Lastly, the factor scores can be calculated via the <code>penfaPredict</code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fscores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/penfaPredict.html">penfaPredict</a></span><span class="op">(</span><span class="va">scad.fit</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">fscores</span><span class="op">)</span>
<span class="co">##             help      voice</span>
<span class="co">## [1,] -0.43671234  0.1423077</span>
<span class="co">## [2,] -0.08680255 -0.3588021</span>
<span class="co">## [3,]  0.56857657  0.6977846</span>
<span class="co">## [4,]  0.10895357  0.6192328</span>
<span class="co">## [5,]  0.37877758  0.8663068</span>
<span class="co">## [6,] -0.63062039 -0.4843055</span></code></pre></div>
</div>
<div id="mcp" class="section level3">
<h3 class="hasAnchor">
<a href="#mcp" class="anchor"></a>Mcp</h3>
<p>We can fit a penalized factor model with the mcp penalty in a way similar to the scad. By default the shape parameter of the mcp is set to 3. This value can be conveniently modified through the <code>a.mcp</code> argument. See <code><a href="../reference/penfaOptions.html">?penfaOptions</a></code> for additional details on the possible options.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">GBIC.mcp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">eta.grid</span>, <span class="va">penfa.fixedTun</span>, penalty <span class="op">=</span> <span class="st">"mcp"</span><span class="op">)</span>

<span class="va">optimtun.mcp</span> <span class="op">&lt;-</span> <span class="va">eta.grid</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">GBIC.mcp</span><span class="op">)</span><span class="op">]</span><span class="op">]</span>
<span class="va">q</span> <span class="op">&lt;-</span> <span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/plotly/reference/plot_ly.html">plot_ly</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">eta.grid</span>, y <span class="op">=</span> <span class="va">GBIC.mcp</span>, type <span class="op">=</span> <span class="st">'scatter'</span>, mode <span class="op">=</span> <span class="st">'lines'</span><span class="op">)</span>
<span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/plotly/reference/layout.html">layout</a></span><span class="op">(</span><span class="va">q</span>,  xaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>showline <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
               title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"GBIC values across tuning parameters"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-0e6310b4af2656c490c8" style="width:576px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-0e6310b4af2656c490c8">{"x":{"visdat":{"155e3a8a9b68":["function () ","plotlyVisDat"]},"cur_data":"155e3a8a9b68","attrs":{"155e3a8a9b68":{"x":[0,0.003,0.006,0.009,0.012,0.015,0.018,0.021,0.024,0.027,0.03,0.033,0.036,0.039,0.042,0.045,0.048,0.051,0.054,0.057,0.06,0.063,0.066,0.069,0.072,0.075,0.078,0.081,0.084,0.087,0.09,0.093,0.096,0.099,0.102,0.105,0.108,0.111,0.114,0.117,0.12,0.123,0.126,0.129,0.132,0.135,0.138,0.141,0.144,0.147,0.15],"y":[17396.1792565921,17389.6014759371,17381.8985595585,17377.4475003526,17376.3984090847,17366.7360541118,17363.7258104133,17361.2810838858,17358.193314763,17356.6180355128,17355.6061477839,17354.7982325977,17354.2739316285,17353.9220955603,17353.6947504621,17353.5352135507,17353.4181261318,17353.2631209068,17353.1869279438,17352.8850324691,17352.493304288,17352.1550759209,17351.8134442289,17351.2970438153,17350.8362712574,17350.3122521058,17349.8421009111,17349.4869610913,17349.1025940873,17348.8114388425,17348.9485834663,17349.0132706108,17349.1521395547,17349.3008674659,17349.4710740376,17349.6506695093,17349.8386729338,17350.0313704767,17350.2367433414,17350.3022750224,17349.962718912,17350.0643657053,17349.983056132,17349.9798166904,17346.934432036,17346.887432695,17346.8997203142,17346.871952064,17346.8885200426,17347.2625347378,17347.7291482246],"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"showline":true,"title":[]},"title":{"text":"GBIC values across tuning parameters"},"yaxis":{"domain":[0,1],"automargin":true,"title":[]},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[0,0.003,0.006,0.009,0.012,0.015,0.018,0.021,0.024,0.027,0.03,0.033,0.036,0.039,0.042,0.045,0.048,0.051,0.054,0.057,0.06,0.063,0.066,0.069,0.072,0.075,0.078,0.081,0.084,0.087,0.09,0.093,0.096,0.099,0.102,0.105,0.108,0.111,0.114,0.117,0.12,0.123,0.126,0.129,0.132,0.135,0.138,0.141,0.144,0.147,0.15],"y":[17396.1792565921,17389.6014759371,17381.8985595585,17377.4475003526,17376.3984090847,17366.7360541118,17363.7258104133,17361.2810838858,17358.193314763,17356.6180355128,17355.6061477839,17354.7982325977,17354.2739316285,17353.9220955603,17353.6947504621,17353.5352135507,17353.4181261318,17353.2631209068,17353.1869279438,17352.8850324691,17352.493304288,17352.1550759209,17351.8134442289,17351.2970438153,17350.8362712574,17350.3122521058,17349.8421009111,17349.4869610913,17349.1025940873,17348.8114388425,17348.9485834663,17349.0132706108,17349.1521395547,17349.3008674659,17349.4710740376,17349.6506695093,17349.8386729338,17350.0313704767,17350.2367433414,17350.3022750224,17349.962718912,17350.0643657053,17349.983056132,17349.9798166904,17346.934432036,17346.887432695,17346.8997203142,17346.871952064,17346.8885200426,17347.2625347378,17347.7291482246],"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>The tuning value equal to 0.141 generated the model with the lowest GBIC.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mcp.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/penfa.html">penfa</a></span><span class="op">(</span><span class="co">## factor model </span>
                 model <span class="op">=</span> <span class="va">syntax</span>, 
                 data <span class="op">=</span> <span class="va">ccdata</span>, 
                 std.lv <span class="op">=</span> <span class="cn">TRUE</span>, 
                 <span class="co">## penalization</span>
                 pen.shrink <span class="op">=</span> <span class="st">"mcp"</span>, 
                 <span class="co"># optimal tuning</span>
                 eta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shrink <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lambda"</span> <span class="op">=</span> <span class="va">optimtun.mcp</span><span class="op">)</span>, diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"none"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
                 strategy <span class="op">=</span> <span class="st">"fixed"</span>, 
                 verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mcp.fit</span><span class="op">)</span>
<span class="co">## penfa 0.0.0.9000 reached convergence</span>
<span class="co">## </span>
<span class="co">##   Number of observations                                    767</span>
<span class="co">##   Number of groups                                            1</span>
<span class="co">##   Number of observed variables                               12</span>
<span class="co">##   Number of latent factors                                    2</span>
<span class="co">##                                                                </span>
<span class="co">##   Estimator                                                PMLE</span>
<span class="co">##   Optimization method                              trust-region</span>
<span class="co">##   Information                                            fisher</span>
<span class="co">##   Strategy                                                fixed</span>
<span class="co">##   Number of iterations                                       40</span>
<span class="co">##   Number of parameters:                                        </span>
<span class="co">##     Free                                                     13</span>
<span class="co">##     Penalized                                                22</span>
<span class="co">##   Effective degrees of freedom                           26.428</span>
<span class="co">##   GIC                                                 17224.179</span>
<span class="co">##   GBIC                                                17346.872</span>
<span class="co">##                                                                </span>
<span class="co">##   Penalty function:                                            </span>
<span class="co">##     Sparsity                                                mcp</span>
<span class="co">##                                                                </span>
<span class="co">##   Additional tuning parameter                                  </span>
<span class="co">##     mcp                                                       3</span>
<span class="co">##                                                                </span>
<span class="co">##   Optimal tuning parameter:                                    </span>
<span class="co">##     Sparsity                                                   </span>
<span class="co">##      - Factor loadings                                    0.141</span>
<span class="co">##                                                                </span>
<span class="co">## </span>
<span class="co">## Parameter Estimates:</span>
<span class="co">## </span>
<span class="co">## Latent Variables:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##   help =~                                                      </span>
<span class="co">##     h1               pen       0.779    0.030    0.720    0.839</span>
<span class="co">##     h2               pen       0.874    0.029    0.818    0.931</span>
<span class="co">##     h3               pen       0.788    0.030    0.729    0.847</span>
<span class="co">##     h4               pen       0.914    0.030    0.854    0.974</span>
<span class="co">##     h5               pen       0.828    0.033    0.762    0.893</span>
<span class="co">##     h6               pen       0.807    0.037    0.735    0.879</span>
<span class="co">##     h7               pen       0.506    0.050    0.408    0.604</span>
<span class="co">##     v1             fixed       0.000             0.000    0.000</span>
<span class="co">##     v2               pen       0.000                           </span>
<span class="co">##     v3               pen       0.000                           </span>
<span class="co">##     v4               pen       0.000                           </span>
<span class="co">##     v5               pen      -0.000                           </span>
<span class="co">##   voice =~                                                     </span>
<span class="co">##     h1             fixed       0.000             0.000    0.000</span>
<span class="co">##     h2               pen      -0.001                           </span>
<span class="co">##     h3               pen       0.000                           </span>
<span class="co">##     h4               pen      -0.018                           </span>
<span class="co">##     h5               pen       0.042                           </span>
<span class="co">##     h6               pen       0.087    0.027    0.035    0.139</span>
<span class="co">##     h7               pen       0.371    0.049    0.275    0.467</span>
<span class="co">##     v1               pen       0.862    0.029    0.806    0.919</span>
<span class="co">##     v2               pen       0.882    0.028    0.826    0.937</span>
<span class="co">##     v3               pen       0.852    0.029    0.795    0.909</span>
<span class="co">##     v4               pen       0.853    0.029    0.796    0.910</span>
<span class="co">##     v5               pen       0.814    0.030    0.756    0.872</span>
<span class="co">## </span>
<span class="co">## Covariances:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##   help ~~                                                      </span>
<span class="co">##     voice           free       0.879    0.011    0.857    0.900</span>
<span class="co">## </span>
<span class="co">## Variances:</span>
<span class="co">##                     Type    Estimate  Std.Err     2.5%    97.5%</span>
<span class="co">##    .h1              free       0.384    0.021    0.343    0.426</span>
<span class="co">##    .h2              free       0.231    0.014    0.203    0.258</span>
<span class="co">##    .h3              free       0.370    0.021    0.330    0.411</span>
<span class="co">##    .h4              free       0.186    0.012    0.162    0.210</span>
<span class="co">##    .h5              free       0.236    0.014    0.208    0.263</span>
<span class="co">##    .h6              free       0.201    0.012    0.177    0.226</span>
<span class="co">##    .h7              free       0.265    0.015    0.236    0.294</span>
<span class="co">##    .v1              free       0.244    0.015    0.214    0.273</span>
<span class="co">##    .v2              free       0.208    0.013    0.181    0.234</span>
<span class="co">##    .v3              free       0.261    0.016    0.230    0.292</span>
<span class="co">##    .v4              free       0.260    0.016    0.229    0.291</span>
<span class="co">##    .v5              free       0.326    0.019    0.289    0.363</span>
<span class="co">##     help           fixed       1.000             1.000    1.000</span>
<span class="co">##     voice          fixed       1.000             1.000    1.000</span></code></pre></div>
</div>
</div>
<div id="conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h2>
<p>Implementing the above approach in the multiple-group case would imply carrying out grid searches in three dimensions to find the optimal tuning parameter vector. This is clearly not advisable, as it would introduce further complications and possibly new computational problems and instabilities. For this reason, we suggest users to rely on the automatic tuning parameter selection procedure, whose applicability is demonstrated in the package vignettes for single (<code><a href="../articles/automatic-tuning-selection.html">vignette("automatic-tuning-selection")</a></code>) and multiple-group (<code><a href="../articles/multiple-group-analysis.html">vignette("multiple-group-analysis")</a></code>) penalized models.</p>
</div>
<div id="r-session" class="section level2">
<h2 class="hasAnchor">
<a href="#r-session" class="anchor"></a>R Session</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">## R version 4.1.0 (2021-05-18)</span>
<span class="co">## Platform: x86_64-apple-darwin17.0 (64-bit)</span>
<span class="co">## Running under: macOS Catalina 10.15.7</span>
<span class="co">## </span>
<span class="co">## Matrix products: default</span>
<span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.dylib</span>
<span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib</span>
<span class="co">## </span>
<span class="co">## locale:</span>
<span class="co">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span>
<span class="co">## </span>
<span class="co">## attached base packages:</span>
<span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">## </span>
<span class="co">## other attached packages:</span>
<span class="co">## [1] penfa_0.0.0.9000</span>
<span class="co">## </span>
<span class="co">## loaded via a namespace (and not attached):</span>
<span class="co">##  [1] tidyselect_1.1.1  xfun_0.24         purrr_0.3.4       colorspace_2.0-2  vctrs_0.3.8      </span>
<span class="co">##  [6] generics_0.1.0    htmltools_0.5.1.1 viridisLite_0.4.0 yaml_2.2.1        utf8_1.2.1       </span>
<span class="co">## [11] plotly_4.9.4.1    rlang_0.4.11      pkgdown_1.6.1     pillar_1.6.1      glue_1.4.2       </span>
<span class="co">## [16] trust_0.1-8       lifecycle_1.0.0   stringr_1.4.0     munsell_0.5.0     gtable_0.3.0     </span>
<span class="co">## [21] ragg_1.1.3        htmlwidgets_1.5.3 memoise_2.0.0     evaluate_0.14     knitr_1.33       </span>
<span class="co">## [26] fastmap_1.1.0     crosstalk_1.1.1   fansi_0.5.0       scales_1.1.1      cachem_1.0.5     </span>
<span class="co">## [31] desc_1.3.0        jsonlite_1.7.2    systemfonts_1.0.2 fs_1.5.0          textshaping_0.3.5</span>
<span class="co">## [36] ggplot2_3.3.5     digest_0.6.27     stringi_1.6.2     dplyr_1.0.7       grid_4.1.0       </span>
<span class="co">## [41] rprojroot_2.0.2   tools_4.1.0       magrittr_2.0.1    lazyeval_0.2.2    tibble_3.1.2     </span>
<span class="co">## [46] crayon_1.4.1      tidyr_1.1.3       pkgconfig_2.0.3   ellipsis_0.3.2    MASS_7.3-54      </span>
<span class="co">## [51] data.table_1.14.0 rmarkdown_2.9     httr_1.4.2        R6_2.5.0          compiler_4.1.0</span></code></pre></div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<ul>
<li><p>Fan, J., &amp; Li, R. 2001. “Variable Selection via Nonconcave Penalized Likelihood and Its Oracle Properties.” Journal of the American Statistical Association 96(456), 1348–60. <a href="https://doi.org/10.1198/016214501753382273">https://doi.org/10.1198/016214501753382273</a></p></li>
<li><p>Fischer, R., Ferreira, M. C., Van Meurs, N. et al. (2019). “Does Organizational Formalization Facilitate Voice and Helping Organizational Citizenship Behaviors? It Depends on (National) Uncertainty Norms.” Journal of International Business Studies, 50(1), 125-134. <a href="https://doi.org/10.1057/s41267-017-0132-6">https://doi.org/10.1057/s41267-017-0132-6</a></p></li>
<li><p>Fischer, R., &amp; Karl, J. A. (2019). “A Primer to (Cross-Cultural) Multi-Group Invariance Testing Possibilities in R.” Frontiers in psychology, 10, 1507. <a href="https://doi.org/10.3389/fpsyg.2019.01507">https://doi.org/10.3389/fpsyg.2019.01507</a></p></li>
<li><p>Geminiani, E. (2020). “A Penalized Likelihood-Based Framework for Single and Multiple-Group Factor Analysis Models.” PhD thesis, University of Bologna. <a href="http://amsdottorato.unibo.it/9355/">http://amsdottorato.unibo.it/9355/</a></p></li>
<li><p>Geminiani, E., Marra, G., &amp; Moustaki, I. (2021). “Single- and Multiple-Group Penalized Factor Analysis: A Trust-Region Algorithm Approach with Integrated Automatic Multiple Tuning Parameter Selection.” Psychometrika, 86(1), 65-95. <a href="https://doi.org/10.1007/s11336-021-09751-8">https://doi.org/10.1007/s11336-021-09751-8</a></p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Elena Geminiani, Giampiero Marra, Irini Moustaki.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
